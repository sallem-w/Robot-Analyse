<HTML><HEAD><TITLE>Web Aneto</TITLE>
<META name=GENERATOR content="IBM WebSphere Studio">
<META content=text/css http-equiv=Content-Style-Type><LINK rel=stylesheet type=text/css href="/Commun/style/Soltim.css"><LINK rel=stylesheet type=text/css href="/Commun/style/Container.css"><!-- Imports JQuery -->
<SCRIPT language=JavaScript src="/Commun/jquery/core/jquery.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/jquery/plugin/blockui/blockui.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/jquery/custom/block/block.js"></SCRIPT>
<!-- JqueryUI -->
<SCRIPT language=JavaScript src="/Commun/jquery/ui/jqueryui.js"></SCRIPT>
<LINK rel=stylesheet type=text/css href="/Commun/jquery/ui/jqueryui.css"><!-- Tooltip -->
<SCRIPT language=JavaScript src="/Commun/jquery/custom/tooltip/tooltip.js"></SCRIPT>
<!-- Notifications -->
<SCRIPT language=JavaScript src="/Commun/jquery/plugin/freeow/freeow.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/jquery/custom/notification/notification.js"></SCRIPT>
<LINK rel=stylesheet type=text/css href="/Commun/jquery/plugin/freeow/freeow.css"><!-- JqGrid (css) --><LINK rel=stylesheet type=text/css href="/Commun/jquery/plugin/jqgrid/jqgrid.css"><!-- Style la page avec JqueryUI -->
<SCRIPT language=JavaScript src="/Commun/js/jqueryuiApply.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/outils.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/container.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/grdo.js"></SCRIPT>
<!-- Import style infinite --><LINK rel=stylesheet type=text/css href="/Commun/style/infinite.css">
<SCRIPT language=javascript>

	<!-- Keep CONTAINER_NOM_SCENARIO_ENREGISTREMENT in JS variable -->
	var scenarioEnregistrement = "ACRE04RE4S_252";


/** 
	Variable indiquant si sur clic entrée on recherche un bouton suivant
	ou Rechercher apres ne pas avoir trouvé la fonction gestionToucheEntree().
	Pour cela mettre la variable a 1.
	Sinon metre 0 
*/
var ACTIVE_RECHERCHE = 0;


function InterceptEnter()
{ 
	var codeEntree = null;
	//Si exception c'est que la fonction n'existe pas.
	try
	{
		codeEntree = gestionToucheEntree();
		GestEnter(codeEntree);
	}
	
	catch(err)
	{
		if(ACTIVE_RECHERCHE == 1)
			GestEnter(codeEntree);
	}
	return true;
}
function GestEnter(codeEntree)
{
	var lienRecherche = null;
	var lienSuivant = null;
	var lien3PP = null;
	var nomZone = null;
	
	/**	Recherche si focus sur zone de recherche 3PP.
	* La bidouille consiste à trouver une image ayant un nom identique à la zone ayant le focus.
	* Exple: zone CodeFournisseur => recherche image ayant comme nom CodeFournisseur_IMG
	*/
	nomZone = document.activeElement.name;
	
	liste = document.getElementsByTagName("a");
	
	if(nomZone && codeEntree == null)
	{
		//Recherche lien 3PP sur la zone
		for(y=0;y<liste.length;y++)
		{
			if(liste[y].name == (nomZone + "_IMG"))
				lien3PP = liste[y];
		}
	}
	
	//si zone 3PP alors appel
	if(lien3PP!=null)
	{
		lien3PP.click();
		return true;
	}
	
	
	
	//Si action RECHERCHE ou non définie.
	if(codeEntree == null || codeEntree == "RECHERCHE")
	{
		for(y=0;y<liste.length;y++)
		{
			if(liste[y].title == "Rechercher" || liste[y].title == "Recherche")
				lienRecherche = liste[y];
		}
	}
	
	//si lien recherche présent alors click et sort
	if(lienRecherche!=null)
	{
		lienRecherche.click();
		return true;
	}
	
	//Si action SUIVANT ou non définie.
	if(codeEntree == null || codeEntree == "SUIVANT")
	{
		for(y=0;y<liste.length;y++)
		{
			if(liste[y].title == "Suivant")
				lienSuivant = liste[y];
		}
	}
	
	//si lien suivant présent alors click et sort
	if(lienSuivant!=null)
	{
		lienSuivant.click();
		return true;
	}
	
	return true;
}
</SCRIPT>

<SCRIPT language=JScript for=document type=text/jscript event=onkeydown()>
	whichASC = event.keyCode;
	try {
		raccourcisClavier();
	} catch(err) {
		if (whichASC == 13) InterceptEnter();
	}
</SCRIPT>

<SCRIPT language=JavaScript>


		// variable nous permettant de connaitre le nombre de boutons à afficher dans la fenêtre
		var boutons = 7;
		var fonction = 0;

/* Appel generique */
function appelGeneriqueFonction(methode)
{
	var cheminContexteWebapp = '/WebAneto';
	var nomFonction= 'AC36';
	var nomFormulaire = 'ac36Form';
	var chemin='/jsp/contrat/vue/AC36.jsp';
	var temp = chemin.substring(5,chemin.length-4);
	var nomDomaine = temp.substring(0,temp.indexOf("/"));
	var nomMethode = "appelGenerique";
	var nomMethodeAppel = methode;
	var scenario='ACRE04RE4S_252';

	var parametreContainerObligatoire = "&CONTAINER_NOM_SCENARIO_ENREGISTREMENT="+scenario+"&CONTAINER_NOM_FONCTION="+nomFonction+"&AFFICHAGE_CONTAINER";

	appelGenerique(cheminContexteWebapp,
							nomFormulaire,nomDomaine,
							nomFonction,nomMethode,nomMethodeAppel,
							parametreContainerObligatoire)

}

function appelUrl()
{
	var url = 'null';
	if (!(url=="null" || url==""))
	{	
		//alert ( "TEST  = " + url);
		win=window.open(url,"ItSoft","");
		win.focus();
	 }
}


function appelUrlCalligo()
{
	var url = 'null';
	if (!(url=="null" || url==""))
	{	
		// on split d'abord l'url 
		var temp = url.split(";");
		// on boucle sur l'appel d'url 
		for(x=0;x<temp.length;x++){
			win=window.open(temp[x],"Calligo" + new Date().getTime(),"");
			win.focus();
		}
	}
}

//TT0016297
function appelUrlGED() {
	var url = 'null';
	if (url != "null") {
//INF0200
		win=window.open(url,"GED","");
		win.focus();
	}
}

/* Gestion des boutons MCR */
var bouton_valider="BOUTON_VALIDER";
var bouton_enregistrer="BOUTON_ENREGISTRER";
var bouton_miseEnInstance="BOUTON_MISE_EN_INSTANCE";
var bouton_fermer="BOUTON_FERMER";
var bouton_suivant="BOUTON_SUIVANT";
var bouton_precedent="BOUTON_PRECEDENT";
var bouton_initialiser="BOUTON_INITIALISER";
var bouton_declenche="";

//Gestion barre de statut et barre de titre.

var barre = '';
var titleJsp = '';

function assignebouton(bouton)
{
	bouton_declenche = '&BOUTON_CONTAINER=' + bouton;
}

function setTitreFenetre(titre)
{
	// Jean-Christophe MICHEL le 22/11/2007 : STAB2.2.1-BARRE-TITRE-02 : Début
	var libTitre = 'null';
	if (libTitre != null && libTitre != "" && libTitre != "null"){
		titre=libTitre+titre;
	}
	// Jean-Christophe MICHEL le 22/11/2007 : STAB2.2.1-BARRE-TITRE-02 : Fin

	//Nettoyage du titre ajouté.
	titleJsp = titre;
	parent.setTitreFenetre(titleJsp);
	return true;
}

function RAZTitreFenetre()
{
	titleJsp = '';
	parent.setTitreFenetre(parent.TITRE);
	return true;
}

function initBarreSatus(){
	//window.alert("initBarre");
	
	barre = "Adhérent : Madame  RUIZ SANDRINE";
	
	setBarreStatus(barre);
	parent.defilement();	// TT0016252
}

function setBarreStatus(szBarre){
	barre = szBarre;
	parent.setBarreStatus(barre);
}
initBarreSatus();

/* fonction permettant l'interrogation de l'utilisateur sur la nécessité de sauvegarder la fonction courante
 retourne '0' S'il choisit Annuler
 retourne '6' S'il choisit Ok
 retourne '7' S'il choisit Non */
function validationVBScript()
{
	return window.showModalDialog('/WebAneto/jsp/container/vue/Confirmation.jsp','','dialogHeight: 130px; dialogWidth: 280px; center: Yes; help: No; resizable: No; status: No;');
}

/* fonction permettant l'interrogation de l'utilisateur sur la nécessité de sauvegarder l'acte de gestion
 retourne '0' S'il choisit Annuler
 retourne '6' S'il choisit Ok
 retourne '7' S'il choisit Non */
function enregistrementVBScript()
{
	return window.showModalDialog('/WebAneto/jsp/container/vue/ConfirmationActe.jsp','','dialogHeight: 130px; dialogWidth: 280px; center: Yes; help: No; resizable: No; status: No;');
}

//STAB221-SMP-008
//Fonction permettant l'appel de la boite de dialogue lors de la fermeture d'un acte en reprise d'instance
function enregistrementActeRepriseInstance()
{
	return window.showModalDialog('/WebAneto/jsp/container/vue/ConfirmationActeRepriseInstance.jsp','','dialogHeight: 200px; dialogWidth: 380px; center: Yes; help: No; resizable: No; status: No;');
}
//Fin STAB221-SMP-008

</SCRIPT>

<SCRIPT language=JavaScript>

/* ferme le scenario sans demander de confirmation à l'utilisateur */
function fermerContainerSansPopup() {
	zzModeForcageValidation = '1';
	posterFormulaire('LancementFonction','debuter','&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=11','');
}

/* Détermine le type de scénario
 zzScenarioForceContainer = '0' : Scénario courant en mode libre
 zzScenarioForceContainer = '1' : Scénario courant en mode forcé */
var zzScenarioForceContainer= '1';
/* Si scénario avec code action 03 : en visualisation */


//STAB221-SMP-008
//Code permettant de savoir si l'acte en cours a été ouvert via la reprise d'instance
var codeActionInitial = "";

//Fin STAB221-SMP-008

/* Permet de lancer la fermeture du container (NEW) */
function newFermerContainer(fonction,scenario)
{
	var isFonctionValidation = false;
	var codeAction = 04;
	
	// Si scénario forcé et l'acte n'est pas en mode visualisation
	// ANO => ED-V2.2.0-ACSO-02
	//if(zzScenarioForceContainer=='1' && zzModeEcranVisualisation=='0'&& (validation == 0 || isFonctionValidation == true))
	/*
		public final static String SCENARIO_CODE_ACTION_CREATION = "01";			==> on doit proposer l'enregistrement
		public final static String SCENARIO_CODE_ACTION_REPRISE_INSTANCE = "02";	==> on doit proposer l'enregistrement
		public final static String SCENARIO_CODE_ACTION_VISUALISATION = "03";		==> on NE doit PAS proposer l'enregistrement
		public final static String SCENARIO_CODE_ACTION_SANS_EFFET = "04";			==> on NE doit PAS proposer l'enregistrement
	*/
	if (zzScenarioForceContainer=='1' && zzModeEcranVisualisation=='0'&& (codeAction != 3  || isFonctionValidation == true))
	{
			// On interroge l'utilisateur s'il veut sauvegarder l'acte
			
			//STAB221-SMP-008
			var userChoise ="";
			if(codeActionInitial == "02"){
				//Si l'acte a été ouvert en reprise d'instance
				userChoise = enregistrementActeRepriseInstance();
			}else{
				userChoise = enregistrementVBScript();
			}
			//Fin STAB221-SMP-008
			
			// Cas ou il veut le sauvegarder
			if(userChoise == '6')
				newLancerFonction('LancementFonction','debuter',fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=1',scenario);
		
			// On sort si l'utilisateur a fait un choix différent de ne pas sauvegarder l'acte
			if(userChoise!='7')
				return;
			// Rajout MCR le 29/11 ano SCE_WEB_SOCLE_001
			if (userChoise == '7'){
				
				setBarreStatus("");
				zzModeForcageValidation = 1;
			}
	}
	else {
		
		userChoice = newInterrogerClientSurValidation();
		if (userChoice == '0') 
			return;
		if (zzModeForcageValidation == '2') {
			// Scénario libre avec sauvegarde
			posterFormulaire('LancementFonction', 'debuter', fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=12', scenario);
			return;
		}
	}
	posterFormulaire('LancementFonction','debuter',fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=11',scenario);

}
/* Postage d'un lancement de fonction */
function posterFormulaire(mapping,methode,fonction,scenario)
{

	if(scenario=='')
			scenario='ACRE04RE4S_252';
	var actionValue= '/WebAneto/container/'+mapping+'.do?method='+methode
						+'&CONTAINER_NOM_SCENARIO_ENREGISTREMENT='+scenario+'&CONTAINER_NOM_FONCTION='
						+fonction ;
	basiquePosterFormulaire(scenario,actionValue);

}
/* Postage d'un lancement de fonction scénario */
function posterFormulaireScenario(mapping,methode,scenario)
{

		var scenarioCourant='ACRE04RE4S_252';
		var actionValue= '/WebAneto/container/'+mapping+'.do?method='+methode
							+'&CONTAINER_NOM_SCENARIO_ENREGISTREMENT='+scenarioCourant+'&CONTAINER_NOM_SCENARIO_FILS='
							+scenario ;

		basiquePosterFormulaire(scenario,actionValue);

}
//MAC_154425 : formulaireDejaPoste : éviter que l'utilisateur ne puisse cliquer plusieurs fois sur les boutons (Christophe RAYMOND)
var formulaireDejaPoste = false;
/* Postage d'un lancement basique */
function basiquePosterFormulaire(scenario,actionValue)
{
	if (formulaireDejaPoste == false) {
	//Suppr MAC_20061102_1244_RKO01 : ligne descendue
	//formulaireDejaPoste = true;
	var i=0;
	var affichageContainer='&AFFICHAGE_CONTAINER=OK';

	var nameFormFonctionSpecification='ac36Form';
	if(document.forms.length>0)
	{
		var documentFormObject=document.forms[0];
		if(document.forms[nameFormFonctionSpecification]!=null)
			documentFormObject=document.forms[nameFormFonctionSpecification];
		
		if(documentFormObject.onsubmit!=null)
		{
			if(documentFormObject.onsubmit()!=false)
				i=1;
		}
		else i=1;

			
		if(i==1)
		{
			actionValue=actionValue + affichageContainer;
			// Ajout Michel pour gestion des boutons
			actionValue=actionValue + bouton_declenche;
			if(zzModeForcageValidation == '1' || (zzModeForcageValidation == '0' && forcageFonctionContainer=='true'))
				actionValue = actionValue+'&CONTAINER_FONCTION_FORCAGE_VALIDATION=FALSE';

			documentFormObject.action=actionValue;
			//Ajout MAC_20061102_1244_RKO01 : ligne descendue
			formulaireDejaPoste = true;
			nePasModifierForcageValidation='false';
			documentFormObject.submit();
		}
	}
	else window.location="/WebAneto/container/LancementScenario.do?method=debuter&CONTAINER_NOM_SCENARIO_ENREGISTREMENT="+ scenario + affichageContainer;
	}
}


/******************** DEBUT ANCIEN FONCTIONNEMENT **************************/
var valideFonctionCouranteContainer;
var forcageFonctionContainer='false';
var presenceBandeau='false';
function ancienFermerContainer(fonction,scenario)
{
		// Cas d'un acte de gestion en mode visualisation
		
		zzValidation='1';
		
		if(zzScenarioForceContainer=='1' && zzValidation=='1')
		{
			valideFonctionCouranteContainer=enregistrementVBScript();
			if(valideFonctionCouranteContainer!=null)
				{
					if(valideFonctionCouranteContainer=='6')
					{
						ancienLancerFonction('LancementFonction','debuter',fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=1',scenario);
					}
					if(valideFonctionCouranteContainer=='7')
					{
						forcageFonctionContainer='true';
						posterFormulaire('LancementFonction','debuter',fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=11',scenario);
					}
				}
		}
		else
		{
			forcageFonctionContainer='true';
			posterFormulaire('LancementFonction','debuter',fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=11',scenario);
		}
}
function ancienLancerFonction(mapping,methode,fonction,scenario)
{
	if(zzBlocageArbreVar=='false')
	{
		// Cas d'un acte de gestion en mode visualisation
		
		if(forcageFonctionContainer=='true')
		{
			posterFormulaire(mapping,methode,fonction,scenario);
		}
		else
		{
			valideFonctionCouranteContainer=validationVBScript();
			if(valideFonctionCouranteContainer!=null)
			{
				if(valideFonctionCouranteContainer=='6')
				{
					posterFormulaire(mapping,methode,fonction,scenario);
				}
				if(valideFonctionCouranteContainer=='7')
				{
					forcageFonctionContainer='true'
					posterFormulaire(mapping,methode,fonction,scenario);
				}
			}
		}
	}

}

function ancienLancerFonctionScenario(mapping,methode,scenario)
{
	if(zzBlocageArbreVar=='false')
	{
		// Cas d'un acte de gestion en mode visualisation
		
		if(forcageFonctionContainer=='true')
		{
			posterFormulaireScenario(mapping,methode,scenario);
		}
		else
		{
			valideFonctionCouranteContainer=validationVBScript();
			if(valideFonctionCouranteContainer!=null)
			{
				if(valideFonctionCouranteContainer=='6')
				{
					posterFormulaireScenario(mapping,methode,scenario);
				}
				if(valideFonctionCouranteContainer=='7')
				{
					forcageFonctionContainer='true'
					posterFormulaireScenario(mapping,methode,scenario);
				}
			}
		}
	}
}
/******************** FIN ANCIEN FONCTIONNEMENT **************************/
</SCRIPT>
</HEAD>
<BODY id=containerBody onload=Javascript:initialisation() leftMargin=0 topMargin=0 bgColor=#ffffff>
<DIV id=notification class="freeow freeow-top-right" jQuery17109080263870954677="4"></DIV><!-- Affichage des boutons de navigation   --><!-- Affichage des boutons de navigation autre que Fermer   --><!-- Affichage des boutons de navigation   --><!-- Affichage des boutons de navigation autre que Fermer   --><!-- Affichage des boutons de navigation   --><!-- Affichage des boutons de navigation autre que Fermer   --><!-- Affichage des boutons de navigation   --><!-- Gestion des groupes de données 
	 Michel Crumière le 29/12/2005-->
<SCRIPT language=JavaScript>


</SCRIPT>

<DIV id=Container jQuery17109080263870954677="3">
<DIV id=arbreContainer>
<DIV id=scenario style="HEIGHT: 586px"><!-- Identifiant scénario pour injecteur --><INPUT type=hidden value=ACRE04RE4S_252 name=zz_NomScenario>
<SCRIPT language=JavaScript src="/Commun/js/arbreNC.js">
</SCRIPT>

<SCRIPT language=JavaScript>

// Java script composant l'arbre

USETEXTLINKS = 1
STARTALLOPEN = 0
USEFRAMES = 0
USEICONS = 1
WRAPTEXT = 0
PERSERVESTATE = 1
ICONPATH="/Commun/multimedia/images/arbre/"
NODEIDTODEPLOY = 'empty';

//FGA : Tableau pour occultation arbre (boutons fonctions du container)
TABLIEN = new Array(Array)
TABLIEN[0][0] = "Valider";
TABLIEN[1] = new Array(Array);
//NC1472617 : Mise en phase avec l'id du bouton "Reinitialiser" de la jsp NavigationNC pour une gestion correcte de son affichage (s'appuie sur l'id "lien"+nom_bouton).
TABLIEN[1][0] = "Reinit";
TABLIEN[2] = new Array(Array);
TABLIEN[2][0] = "Precedent";
TABLIEN[3] = new Array(Array);
TABLIEN[3][0] = "Suivant";
TABLIEN[4] = new Array(Array);
TABLIEN[4][0] = "MEI";
TABLIEN[5] = new Array(Array);
TABLIEN[5][0] = "Enregistrer";
		
foldersTree = gFld('Sans effet     ', '#','','s3');
foldersTree.xID = 'ACRE04RE4S_252';

				 aux1 = insFld(foldersTree, gFld('Ident contrat', 'JavaScript:lancerFonction("LancementFonction","debuter","ACIC_100","ACRE04RE4S_252");','18','s4'));
				 aux1.xID = 'ACIC_100ACRE04RE4S_252';
				
				 aux1 = insFld(foldersTree, gFld('Param.calc.', 'JavaScript:lancerFonction("LancementFonction","debuter","AC32_200","ACRE04RE4S_252");','18','s4'));
				 aux1.xID = 'AC32_200ACRE04RE4S_252';
				
				 aux1 = insFld(foldersTree, gFld('Histo. cotis.', 'JavaScript:lancerFonction("LancementFonction","debuter","AC3Q_300","ACRE04RE4S_252");','18','s4'));
				 aux1.xID = 'AC3Q_300ACRE04RE4S_252';
				
						NODEIDTODEPLOY = ('AC36_400ACRE04RE4S_252');
					
				 aux1 = insFld(foldersTree, gFld('Visu. cpt cotis', 'JavaScript:lancerFonction("LancementFonction","debuter","AC36_400","ACRE04RE4S_252");','18','s5'));
				 aux1.xID = 'AC36_400ACRE04RE4S_252';
				
				 aux1 = insFld(foldersTree, gFld('Validation acte', '#','19','s4'));
				 aux1.xID = 'ACVV_500ACRE04RE4S_252';
				

// Fonction Javascript permettant le blocage de tous les liens de l'arbre

function blocageArbre(blocage)
{
	zzBlocageArbreVar=blocage;	
	zzBlocageArbreActiveVar='true';
	zzBlocageArbreAction();
	
}
function zzBlocageArbreAction()
{
	if(zzBlocageArbreActiveVar=='true')
	{
		listhref= document.getElementsByTagName("a");
		
		for(i=0;i!=listhref.length;i++)
			{
				if(listhref[i].id.substring(0,18) == 'itemDrawFolderLink'
				|| listhref[i].id.substring(0,12) == 'itemTextLink'
				|| listhref[i].id.substring(0,18) == 'itemFolderHTMLLink'
				|| listhref[i].id.substring(0,12) == 'itemIconLink')
				{
					if(zzBlocageArbreVar=='true')
						listhref[i].disabled=true;
					else listhref[i].disabled=false;
				}
			}
		
		//FGA:Blocage des boutons du container + image grisé + curseur sans main
		for(i=0;i<TABLIEN.length;i++)
		{
			objLink = document.getElementById("lien"+TABLIEN[i][0]);
			objImg = document.getElementById("bt"+TABLIEN[i][0]);
			if(objLink && objImg)
			{
				if(zzBlocageArbreVar=='true')
				{
					TABLIEN[i][1] = objLink.href;
					objLink.href = '#';
					//Image du bouton grisée + curseur sans main +sav href et mouseover.
					objImg.style.filter = "alpha(opacity=30)"; 
					TABLIEN[i][2] = objImg.onmouseover; 
					objImg.onmouseover ='';
					objImg.style.cursor = "default";					
				}
				else
				{
					if(TABLIEN[i][1] && TABLIEN[i][1]!="")
						objLink.href = TABLIEN[i][1];
					objImg.style.filter = "alpha(opacity=100)";
					if(TABLIEN[i][2] && TABLIEN[i][2]!="")
						objImg.onmouseover =  TABLIEN[i][2]; 
					objImg.style.cursor = "auto";
				}
			}
		}
	}
}

function goFocusScroll() {
	if (document.getElementById("scrolltop").value != null) {
		val = document.getElementById('scrolltop').value;
		document.getElementById('scenario').scrollTop = val;
	}		
	//-- Ajout LPI
	goFocusArbre();
	//-- Fin LPI
}

function goFocusArbre() {
	if (document.getElementById("folderSel").value != null) {
		noSel = document.getElementById("folderSel").value;
		if (document.getElementById("itemTextLink"+noSel) != null) {
			$("#itemTextLink"+noSel).focus();
		}			
	}	
}

</SCRIPT>
 <INPUT id=folderSel type=hidden value=4 length="4"> <INPUT id=scrolltop type=hidden length="4"> 
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR vAlign=top>
<TD colSpan=2>
<TABLE cellSpacing=0 cellPadding=5 width="100%" border=0>
<TBODY>
<TR>
<TD>
<SCRIPT language=Javascript>initializeDocument(NODEIDTODEPLOY);</SCRIPT>

<DIV id=domRoot>
<DIV id=folder0 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre0></A>
<TBODY>
<TR>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACRE04RE4S_252","0", false)' id=itemFolderHTMLLink class=s3 href="http://infinite-haur05/WebAneto/container/LancementFonction.do?method=debuter&amp;CONTAINER_NOM_SCENARIO_ENREGISTREMENT=ACRE04RE4S_252&amp;CONTAINER_NOM_FONCTION=AC36_400&amp;AFFICHAGE_CONTAINER=OK&amp;BOUTON_CONTAINER=BOUTON_SUIVANT#"><IMG id=folderIcon0 border=0 name=folderIcon0 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap>
<DIV class=s3>Sans effet </DIV></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder1 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre1></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACIC_100ACRE04RE4S_252")'><IMG id=nodeIcon1 border=0 name=nodeIcon1 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACIC_100ACRE04RE4S_252","1", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACIC_100","ACRE04RE4S_252");'><IMG id=folderIcon1 border=0 name=folderIcon1 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACIC_100ACRE04RE4S_252","1", false)' id=itemTextLink1 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACIC_100","ACRE04RE4S_252");'>Ident contrat</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder2 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre2></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("AC32_200ACRE04RE4S_252")'><IMG id=nodeIcon2 border=0 name=nodeIcon2 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("AC32_200ACRE04RE4S_252","2", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC32_200","ACRE04RE4S_252");'><IMG id=folderIcon2 border=0 name=folderIcon2 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("AC32_200ACRE04RE4S_252","2", false)' id=itemTextLink2 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC32_200","ACRE04RE4S_252");'>Param.calc.</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder3 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre3></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("AC3Q_300ACRE04RE4S_252")'><IMG id=nodeIcon3 border=0 name=nodeIcon3 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("AC3Q_300ACRE04RE4S_252","3", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC3Q_300","ACRE04RE4S_252");'><IMG id=folderIcon3 border=0 name=folderIcon3 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("AC3Q_300ACRE04RE4S_252","3", false)' id=itemTextLink3 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC3Q_300","ACRE04RE4S_252");'>Histo. cotis.</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder4 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre4></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("AC36_400ACRE04RE4S_252")'><IMG id=nodeIcon4 border=0 name=nodeIcon4 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("AC36_400ACRE04RE4S_252","4", false)' id=itemFolderHTMLLink class=s5 href='javascript:lancerFonction("LancementFonction","debuter","AC36_400","ACRE04RE4S_252");'><IMG id=folderIcon4 border=0 name=folderIcon4 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("AC36_400ACRE04RE4S_252","4", false)' id=itemTextLink4 class=s5 href='javascript:lancerFonction("LancementFonction","debuter","AC36_400","ACRE04RE4S_252");'>Visu. cpt cotis</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder5 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre5></A>
<TBODY>
<TR>
<TD vAlign=top><A id=itemDrawFolderLink href='javascript:clickOnNode("ACVV_500ACRE04RE4S_252")'><IMG id=nodeIcon5 border=0 name=nodeIcon5 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2lastnode.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACVV_500ACRE04RE4S_252","5", false)' id=itemFolderHTMLLink class=s4 href="http://infinite-haur05/WebAneto/container/LancementFonction.do?method=debuter&amp;CONTAINER_NOM_SCENARIO_ENREGISTREMENT=ACRE04RE4S_252&amp;CONTAINER_NOM_FONCTION=AC36_400&amp;AFFICHAGE_CONTAINER=OK&amp;BOUTON_CONTAINER=BOUTON_SUIVANT#"><IMG id=folderIcon5 border=0 name=folderIcon5 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier19.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap>
<DIV class=s4>Validation acte</DIV></TD></TR></TBODY></TABLE></DIV></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<SCRIPT language=JavaScript>
	if (document.getElementById("folderSel").value != null) {
		noSel = document.getElementById("folderSel").value;

		// -- Modif LPI du 15/12/2010	
		//nbFn = 20;
		hauteurDiv = document.getElementById("scenario").offsetHeight;
		hauteurFolder = document.getElementById("itemDrawFolderLink").offsetHeight;
		valeur = hauteurDiv / hauteurFolder;
		nbFn = Math.ceil(valeur);
		// -- Fin LPI

		val = document.getElementById('scrolltop').value;
		if (noSel < nbFn) {
			goFocusArbre();
		} else {	
			goFocusScroll();
		}
	}	
</SCRIPT>
</DIV>
<DIV id=zonebouton style="HEIGHT: 226px">
<DIV id=bouton>
<SCRIPT language=JavaScript>
		// Ajout SCE_ZZWEB_004
		var tabFonctions = new Array();
	</SCRIPT>

<DIV id=boutonFonction><A href="JavaScript:gestionBoutonFonction();"><IMG onmouseover="javascript:afficheBoutonOn('btFonction','128');" onmouseout="javascript:afficheBoutonOff('btFonction','128');" id=btFonction title=Fonction border=0 src="/Commun/multimedia/images/container/128.gif"></A> </DIV>
<DIV id=boutGestBoutonFonction class=divColor style="HEIGHT: 8px; WIDTH: 100px; POSITION: absolute; LEFT: 160px; DISPLAY: none; TOP: 250px">
<DIV></DIV></DIV>
<DIV id=gestBoutonFonction class=divColor style="HEIGHT: 15px; POSITION: absolute; LEFT: 190px; Z-INDEX: 200; DISPLAY: none; TOP: 608px"><IFRAME style="HEIGHT: 20px; WIDTH: 150px; POSITION: absolute; LEFT: 0px; FILTER: mask(); Z-INDEX: -1; DISPLAY: block; TOP: 0px"></IFRAME>
<TABLE cellSpacing=0 cellPadding=0 width=150 border=0>
<TBODY>
<TR>
<TD width="100%"><A class=S3 href="javascript:posterFormulaire('LancementFonction', 'debuter', 'AC3Q_300&amp;CONTAINER_FONCTION_FORCAGE_VALIDATION=FALSE', 'ACRE04RE4S_252');"><B>&nbsp;&nbsp;Abandonner</B></A><BR></TD></TR></TBODY></TABLE></DIV><!-- Affichage du boutons de navigation Précédent -->
<DIV id=boutonPrecedent><A id=lienPrecedent title=Précédent href="JavaScript:assignebouton(bouton_precedent);lancerFonction('LancementFonction','debuter','AC3Q_300','ACRE04RE4S_252','');"><IMG onmouseover="javascript:afficheBoutonOn('btPrecedent','107');" onmouseout="javascript:afficheBoutonOff('btPrecedent','107');" id=btPrecedent border=0 src="/Commun/multimedia/images/container/107.gif"></A> </DIV><!-- Affichage du bouton de navigation Suivant --><!-- DEBUT ED-V2.2.0-GRC-001 -->
<DIV id=boutonSuivant><A id=lienSuivant title=Suivant href="JavaScript:assignebouton(bouton_suivant);posterFormulaire('LancementFonction','debuter','ACVV_500','ACRE04RE4S_252');"><IMG onmouseover="javascript:afficheBoutonOn('btSuivant','121');" onmouseout="javascript:afficheBoutonOff('btSuivant','121');" id=btSuivant border=0 src="/Commun/multimedia/images/container/121.gif"></A> </DIV><!-- FIN ED-V2.2.0-GRC-001 --><!-- Affichage du boutons de navigation Enregistrer  --><!-- DEBUT ED-V2.2.0-PSCD-001 --><!-- FIN ED-V2.2.0-PSCD-001 --><!-- Affichage du boutons de navigation Mis en instance  -->
<DIV id=boutonMiseEnInstance><IMG style="FILTER: alpha(opacity=30)" border=0 src="/Commun/multimedia/images/container/123.gif"> </DIV><!-- DEBUT AC_ZZ_STAB221_001 
		Affichage du bouton réinitialiser au dessus du bouton fermer
	--><!-- Affichage du boutons de navigation Reinitialiser -->
<DIV id=boutonReinit><A id=lienReinit href="Javascript:posterFormulaire('LancementFonction','debuter','AC36_400&amp;CONTAINER_FONCTION_FORCAGE_VALIDATION=FALSE&amp;BOUTON_CONTAINER=BOUTON_INITIALISER','ACRE04RE4S_252');"><IMG onmouseover="javascript:afficheBoutonOn('btReinit','202');" onmouseout="javascript:afficheBoutonOff('btReinit','202');" id=btReinit title=Réinitialiser border=0 src="/Commun/multimedia/images/container/202.gif"> </A></DIV><!-- FIN AC_ZZ_STAB221_001 --><!-- Affichage du bouton d'aide -->
<DIV id=boutonAide><A id=lienAide href="JavaScript:openHelp();"><IMG onmouseover="javascript:afficheBoutonOn('btAide','129');" onmouseout="javascript:afficheBoutonOff('btAide','129');" id=btAide title=Aide border=0 src="/Commun/multimedia/images/container/129.gif"></A> </DIV><!-- Affichage du boutons de navigation Fermer -->
<DIV id=boutonFermer><A id=lienFermer href="JavaScript:assignebouton(bouton_fermer);fermerContainer('ACVV_500','ACRE04RE4S_252');"><IMG onmouseover="javascript:afficheBoutonOn('btFermer','127');" onmouseout="javascript:afficheBoutonOff('btFermer','127');" id=btFermer title=Fermer border=0 src="/Commun/multimedia/images/container/127.gif"></A> </DIV>
<SCRIPT language=JavaScript src="/Commun/js/aide.js"></SCRIPT>

<SCRIPT language=JavaScript>
	
	/****************************************************************
	* Fonctions liées au bouton Fonction.
	* Ajout, supression de fonctions secondaires.
	* Calcul placement des boutons.
	****************************************************************/
		function trim (chaine) {
 			chaine = unescape(chaine);
			 return chaine.replace(/(^\s*)|(\s*$)/g, "");
		}
	
		var htmlFonction = "";
		var nomForm = '';
		var nomFonction= 'AC36';
	
		var libelle = '';
		var parametre1 = '';
		var parametre2 = '';
		var action2 = '';
		var action = '';
		var scenar = 'ACRE04RE4S_252';
        var contextPath = '/WebAneto';
		
		// Début Ajout SCE_ZZWEB_004
		fonction = 0;
		tabFonctions = new Array();
		// Fin Ajout SCE_ZZWEB_004
		

		// Fonction ajoutée pour SCE_ZZWEB_004
		function _reaffichageMenu() {
			var htmlFonction = '';
			if (fonction > 0) { 
				var hIframe = (15*fonction) + 5;
				htmlFonction += '<iframe style="{display:block;position:absolute;top:0;left:0;z-index:-1;filter:mask();width:150px;height:'+hIframe+';}"></iframe>';
				htmlFonction += '<table border="0" width="150px" cellspacing="0" cellpadding="0"><tr><td width="100%">';
				for(var i = 0; i < fonction; i++) {
					if (tabFonctions[i][1]=="MO" || tabFonctions[i][1]=="VI") {
						htmlFonction += tabFonctions[i][2];
					}
				}
				htmlFonction += '</td></tr></table>';
			}
			document.getElementById("gestBoutonFonction").innerHTML = [htmlFonction];
			calculPlaceSsFct();
		}

		// Fonction ajoutée pour SCE_ZZWEB_004
		function creerNouvelleFonctionJS(libelle, nomFonction, parametres) {

			var chaineParametres = '';
			var libBulle = '';
			
			if (libelle.length > 25) {
				libBulle = libelle;
				libelle = libelle.substr(0, 22) + '...';
			}
			for(var i = 0; i < parametres.length; i++) {
				chaineParametres += '\'' + parametres[i] + '\'';
				if (i<parametres.length-1) {
					chaineParametres += ', ';
				}
			}

			var fonctionExiste = false;
			for(var i = 0; i < fonction; i++) {
				if (tabFonctions[i][0] == libelle) {
					fonctionExiste = true;
				}
			}

			if (!fonctionExiste) {
				var menu = '<A href="JavaScript:' + nomFonction + '(' + chaineParametres + ');" class="S3"';
				if (libBulle != '') {
					// SBD_TT27005 Ajout info bulle si libellé tronqué
					menu += ' title="' + libBulle + '"';
				}
				menu += '><b>&nbsp;&nbsp;'+ libelle + '</b></A><br>';
				tabFonctions[fonction] = new Array(libelle, 'VI', menu);
				fonction = fonction + 1;
			}

			_reaffichageMenu();
		}

		// Fonction ajoutée pour SCE_ZZWEB_004
		function cacherFonctionOptionnelle(nom) {
			if (nom.length > 25) {
				// SBD_TT27005 Recherche le libellé tronqué
				nom = nom.substr(0, 22) + '...';
			}
			for (var i = 0; i < fonction; i++) {
				if (tabFonctions[i][0] == nom) {
					tabFonctions[i][1] = "CA";
				}
			}
			_reaffichageMenu();
		}

		// Fonction ajoutée pour SCE_ZZWEB_004
		function montrerFonctionOptionnelle(nom) {
			if (libelle.length > 25) {
				// SBD_TT27005 Recherche le libellé tronqué
				libelle = libelle.substr(0, 22) + '...';
			}
			for (var i = 0; i < fonction; i++) {
				if (tabFonctions[i][0] == nom) {
					tabFonctions[i][1] = "VI";
				}
			}
			_reaffichageMenu();
		}
		
		/**********************************
		* Calcule le placements des boutons de navigation
		* par rapport à l'arbre et la place des fonctions
		* secondaires.
		**************************************/
		function calculPlaceBoutons()
		{
			//TT9031		
			var heightcontenuFrame = parent.heightcontenuFrame;
			if (heightcontenuFrame == 0) {
				heightcontenuFrame = parseInt(document.body.clientHeight);
				parent.heightcontenuFrame = heightcontenuFrame;
			}
			//Fin TT9031
			// on calcul la hauteur  = place + ( 30 * place par boutons)+( 15 * place par fonction)
			var height = (heightcontenuFrame - (33*boutons));
			var obj = document.getElementById('scenario');
			obj.style.height = height;
			var obj2 = document.getElementById('zonebouton');
			obj2.style.height = heightcontenuFrame - height;
			return true;
		}
		
		function calculPlaceSsFct()
		{
			var objDiv = document.getElementById('gestBoutonFonction');
			//Calcul de la place qu'il faut pour placer les sous fonctions.
			var objContainer = document.getElementById('zonebouton');
			
			objDiv.style.left = 190;
			var objDivHeight = 15*fonction;
			objDiv.style.height = objDivHeight;
			var hauteurFenetre = parseInt(document.body.clientHeight);
			var pos = 0;
			//Calcul position du calque pour que toutes les fonctions rentrent dans la fenêtre
			if (objDivHeight > objContainer.clientHeight) {
				pos = hauteurFenetre - objDivHeight;
			} else {
				pos = hauteurFenetre - objContainer.clientHeight + 20;
			}
				
			objDiv.style.top = pos;
			
			var objDesign = document.getElementById('boutGestBoutonFonction');
			objDesign.style.width = 100;
			objDesign.style.top = objContainer.clientHeight + 24;
			objDesign.style.left = 160;
			return true;
		}
		
		/***********************************************************
		* Fonction activant l'ouverture de l'aide contextuelle.
		**************************************************************/
		function openHelp()
		{
			var fonction = 'AC36_400';
			var scenario = 'ACRE04RE4S_252';
			var scenarioPere = 'ACRE04RE4S_252';
			var codeActe = 'ACRE';
			var codeAction = '04';
			var codeContexte = 'RE4S'; 
			var applicationContextRoot = "/WebAneto";
			LectureXml(codeActe,fonction,applicationContextRoot)
			//Récup du xml de correspondance code acte/nom doc (ajax).
		}
		//calculPlaceBoutons();
		
		// DEBUT AC_ZZ_STAB221_001
		// supression fonction réinitialiser dans le menu fonction
		//Affichage du bouton Reinitialiser (et donc des ss fonctions données par la jsp (appel reaffichage menu)
		//var tabReinit = new Array('LancementFonction','debuter','AC36_400&amp;CONTAINER_FONCTION_FORCAGE_VALIDATION=FALSE&amp;BOUTON_CONTAINER=BOUTON_INITIALISER','ACRE04RE4S_252');
		//creerNouvelleFonctionJS('Reinitialiser','posterFormulaire',tabReinit);
		// FIN AC_ZZ_STAB221_001
		
		
		// DEBUT STAB221_PSSP_001
		//Affiche les sous fonctions données à la JSP
		//nc 417731 by MJLI move to container.js after jqueyr.show
		//_reaffichageMenu();
		// FIN STAB221_PSSP_001
		
		//Affichage du bouton Abandonner (et donc des ss fonctions données par la jsp (appel reaffichage menu))
		
				var tabAbandon = new Array('LancementFonction','debuter','AC3Q_300&amp;CONTAINER_FONCTION_FORCAGE_VALIDATION=FALSE','ACRE04RE4S_252');
				creerNouvelleFonctionJS('Abandonner','posterFormulaire',tabAbandon);
		

		//Check si aide présente donc bouton à afficher.
		if(!checkAide())
			document.getElementById('boutonAide').style.display = 'none';
	</SCRIPT>
</DIV></DIV>
<SCRIPT language=Javascript>
		</SCRIPT>
</DIV>
<DIV id=contenu style="HEIGHT: 812px"><!-- Cas normal de chargement d'une fonction --><LINK rel=stylesheet type=text/css href="/Commun/style/Soltim.css"><LINK rel=stylesheet type=text/css href="/Commun/style/disabled.css"><LINK rel=stylesheet type=text/css href="/Commun/style/cssDynamique.css">
<SCRIPT language=JavaScript src="/Commun/js/lov.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/calendrier.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/editModeForm.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/MasqueSaisie.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/lmt_navig.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/validateForm.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/disabled.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/cssDynamique.js"></SCRIPT>

<SCRIPT language=Javascript src="/WebAneto/jsp/contrat/js/AC36.js"></SCRIPT>

<META content=text/css http-equiv=Content-Style-Type>
<SCRIPT language=JavaScript>
	getCssValue();

	var controle = "1";
	
	function clicUtil(i) {
		ac36Form.numeroCompte.value = i;
		// GMN 04/05/2009 : On appelle la fonction de recher car le selection compte ne fonctionne pas
		//goNavigationActionSecondaire('ac36Form', 'contrat', 'AC36', 'selectionCompte');
		recherche();
	}
	
	function recherche() {
		controle="0";
		goNavigationActionSecondaire('ac36Form','contrat','AC36','rechercher') ;
	}
	
	function ctlSaisie() {
		if (controle=="1" && valideFonctionCouranteContainer!="7" && document.forms[0].all["nbCompte"].value !=0 && document.ac36Form.topACD6.value == 'true' ) {
			validateForm('validation','','R','la validation calcul (O/N)');
			return document.returnValue;
		} else {
			controle="1";
			return true;
		}
	}

	var parametreRequete='&CONTAINER_NOM_SCENARIO_ENREGISTREMENT=ACRE04RE4S_252&CONTAINER_NOM_FONCTION=AC36_400&AFFICHAGE_CONTAINER=';
	
	function goNavigationActionSecondaire(nomFormulaire,nomDomaine,nomFonction,nomMethode) 
	{
		var requete = '/WebAneto' + '/' +  nomDomaine + '/' 
		+ nomFonction + '.do?method=' + nomMethode;
		document.forms[nomFormulaire].action= requete + parametreRequete;
		zzSubmitForm(document.forms[nomFormulaire]);		
	}
</SCRIPT>

<SCRIPT language=javascript>
function invalidateZZToken(form) {
if(form!= null && form._zzToken_ != null){
form._zzToken_.value = false;
}
zzDisableHref('true');
}
function isZZTokenValid(form) {
if(form!= null && form._zzToken_ != null){
var tokenValue = form._zzToken_.value;
if (tokenValue == 'true') {
return true;
}
}
else return true;
return false;
}
function zzSubmitForm(form) {
if(isZZTokenValid(form)){
if(!pageIsReloaded){
invalidateZZToken(form);
}else{
pageIsReloaded = false;
}
form.submit();
}
}
function zzValidateFormWithTokenActivateac36Form(form){
if(isZZTokenValid(form) && zzPersonnalOnsubmitac36Form() ){
invalidateZZToken(form);
return true;
}
return false;
}
function zzPersonnalOnsubmitac36Form(form) {
return ctlSaisie();return document.returnValue;
 return true;
}
</SCRIPT>

<FORM onsubmit="return zzValidateFormWithTokenActivateac36Form(this);" method=post name=ac36Form action=Container><INPUT id=_zzToken_ type=hidden value=true name=_zzToken_> <INPUT type=hidden name=task> <INPUT type=hidden name=actionContainer> <INPUT type=hidden name=fonctionCourante> <INPUT type=hidden name=continuer> <INPUT type=hidden value=0 name=numeroCompte> 
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR class=TitreGroupeB>
<TD width="90%">Liste des opérations</TD></TR></TBODY></TABLE>
<DIV id=listeOperation class=Liste_B style="HEIGHT: 80px; WIDTH: 100%">
<TABLE id=tableauOperation width="100%" border=0>
<TBODY>
<TR class=LILibelleB1>
<TD noWrap align=center>N°</TD>
<TD noWrap align=center>Date de création</TD>
<TD noWrap align=center>Libellé de l'opération</TD>
<TD noWrap align=center>Etat de l'opération</TD>
<TD noWrap align=center>Type d'opération</TD>
<TD noWrap align=center>Date d'effet</TD>
<TD noWrap align=center>Date de cotisation</TD>
<TD noWrap align=center>Date de vente</TD>
<TD noWrap align=center>Date de demande</TD>
<TD noWrap align=center>Contexte</TD>
<TD noWrap align=center>Numéro de contrat</TD>
<TD noWrap align=center>Opération de génération</TD>
<TD noWrap align=center>Opération annulante</TD>
<TD noWrap align=center>Motif d'instance ou de refus</TD>
<TD noWrap align=center>Code utilisateur de création</TD></TR>
<TR onmouseover=surligneStd(this); onmouseout=retablieStd(this); id=trLigneOpe-1 class=LIDonneeB1>
<TD noWrap align=center>65</TD>
<TD noWrap align=center>16/05/2017</TD>
<TD noWrap align=center>Résiliation CI /Param.calc.</TD>
<TD noWrap align=center>En cours</TD>
<TD noWrap align=center>Calcul</TD>
<TD noWrap align=center>01/05/2017</TD>
<TD noWrap align=center>01/05/2017</TD>
<TD noWrap align=center>01/05/2017</TD>
<TD noWrap align=center>01/05/2017</TD>
<TD noWrap align=center>SANS EFFET</TD>
<TD noWrap align=center>21998269</TD>
<TD noWrap align=center>64</TD>
<TD noWrap align=center>0</TD>
<TD noWrap align=center></TD>
<TD noWrap align=center>SAPCTOR1</TD></TR>
<TR onmouseover=surligneStd(this); onmouseout=retablieStd(this); id=trLigneOpe-1 class=LIDonneeB1>
<TD noWrap align=center>64</TD>
<TD noWrap align=center>16/05/2017</TD>
<TD noWrap align=center>Résiliation CI</TD>
<TD noWrap align=center>En cours</TD>
<TD noWrap align=center>Sans-effet</TD>
<TD noWrap align=center>01/05/2017</TD>
<TD noWrap align=center>01/05/2017</TD>
<TD noWrap align=center>01/05/2017</TD>
<TD noWrap align=center>17/05/2016</TD>
<TD noWrap align=center>SANS EFFET</TD>
<TD noWrap align=center>21998269</TD>
<TD noWrap align=center>0</TD>
<TD noWrap align=center>0</TD>
<TD noWrap align=center></TD>
<TD noWrap align=center>SAPCTOR1</TD></TR></TBODY></TABLE></DIV>
<TABLE cellSpacing=15 width="100%" border=0>
<TBODY>
<TR align=center>
<TD colSpan=2 align=right><A tabIndex=1 title=CalculPrecedent class=AdminBT_B href="javascript:calculPrecedent();">Calcul précédent</A> </TD>
<TD colSpan=2 align=left><A tabIndex=2 disabled title=CalculSuivant class=AdminBT_B href="#" name=calculSuiv>Calcul &nbsp;suivant&nbsp;</A> </TD></TR></TBODY></TABLE><INPUT type=hidden value=1 name=nbCompte> <INPUT type=hidden value=true name=topACD6> <INPUT type=hidden value=false name=topValide> 
<TABLE id=idTableCptCotisant cellPadding=5 width="100%" border=0>
<TBODY>
<TR vAlign=top>
<TD>
<TABLE id=listeCompte width="100%" border=0>
<TBODY>
<TR>
<TD class=TitreGroupeB colSpan=9>Sélection du compte cotisant </TD></TR>
<TR class=LibelleB2>
<TD>&nbsp;</TD>
<TD>Part</TD>
<TD>Calculé</TD>
<TD>Emis</TD>
<TD>Réglé</TD>
<TD>Solde global</TD>
<TD>Solde comptable</TD>
<TD>Groupe d'assurés</TD>
<TD>Entité de rattachement</TD></TR>
<TR onmouseover="JavaScript:MouseOver('0','ListeCompte','B');" onmouseout="JavaScript:MouseOutClick('0','ListeCompte','B');" id=0 class=DonneeB1 style="BACKGROUND-COLOR: #cbe6ff">
<TD><A href="javascript:MajLigne('0','listeCompte','img0'); clicUtil('0');"><IMG border=0 name=img0 alt=Detail src="/Commun/multimedia/images/BT_SelOn.gif"> </A></TD>
<TD>ADH </TD>
<TD align=right>1983.56 </TD>
<TD align=right>633.24 </TD>
<TD align=right>633.24 </TD>
<TD align=right>1350.32 </TD>
<TD align=right>0.00 </TD>
<TD></TD>
<TD>P </TD></TR></TBODY></TABLE></TD></TR>
<TR>
<TD width="100%">
<TABLE width="100%" border=0>
<TBODY>
<TR>
<TD class=TitreGroupeB width="30%" colSpan=2 align=left>Détail </TD>
<TD>&nbsp;</TD>
<TD class=TitreGroupeB colSpan=6 align=left>Solde</TD></TR>
<TR>
<TD class=LibelleB2><INPUT disabled class=styleDisabled CHECKED type=radio value=0 name=niveauDetail stylePrecedent>Echéance </TD>
<TD class=LibelleB2><INPUT disabled class=styleDisabled type=radio value=3 name=niveauDetail stylePrecedent>Exigibilité </TD>
<TD></TD>
<TD class=LibelleB2>Echéance du :</TD>
<TD class=DonneeB2><INPUT onkeypress=javascript:masqueSaisieDateFormate(this); disabled onblur=controleFormatDate(this); class=styleDisabled maxLength=10 size=11 name=debutEcheance stylePrecedent>&nbsp;<A id=cache href="JavaScript:show_calendar('','ac36Form.debutEcheance')" name=debutEcheance_IMG><IMG id=cache style="VISIBILITY: hidden" border=0 alt=Calendrier src="/Commun/multimedia/images/calendar.gif"></A> </TD>
<TD class=LibelleB2>au : </TD>
<TD class=DonneeB2 colSpan=3 align=left><INPUT onkeypress=javascript:masqueSaisieDateFormate(this); disabled onblur=controleFormatDate(this); class=styleDisabled maxLength=10 size=11 name=finEcheance stylePrecedent>&nbsp;<A id=cache href="JavaScript:show_calendar('','ac36Form.finEcheance')" name=finEcheance_IMG><IMG id=cache style="VISIBILITY: hidden" border=0 alt=Calendrier src="/Commun/multimedia/images/calendar.gif"></A> </TD></TR>
<TR>
<TD class=LibelleB2><INPUT disabled class=styleDisabled type=radio value=1 name=niveauDetail stylePrecedent>Nature financière </TD>
<TD class=LibelleB2><INPUT disabled class=styleDisabled type=radio value=2 name=niveauDetail stylePrecedent>N° de créance </TD>
<TD></TD>
<TD class=LibelleB2>Arrété :</TD>
<TD class=DonneeB2 colSpan=4 align=left><INPUT onkeypress=javascript:masqueSaisieDateFormate(this); disabled onblur=controleFormatDate(this); class=styleDisabled maxLength=10 size=11 name=dateArrete stylePrecedent>&nbsp;<A id=cache href="JavaScript:show_calendar('','ac36Form.dateArrete')" name=dateArrete_IMG><IMG id=cache style="VISIBILITY: hidden" border=0 alt=Calendrier src="/Commun/multimedia/images/calendar.gif"></A> </TD>
<TD class=DonneeB2 vAlign=bottom width="10%"><A title=Recherche class=AdminBT_B href="javascript:recherche();">Recherche</A> </TD></TR></TBODY></TABLE></TD></TR><!-- RCR sol1164 -->
<TR>
<TD align=right><SPAN>Validation du calcul : <SELECT id=nonbloque style="FLOAT: none; DISPLAY: inline" name=validation> <OPTION selected></OPTION> <OPTION value=OUI>Oui</OPTION> <OPTION value=NON>Non</OPTION></SELECT> </SPAN></TD></TR>
<TR>
<TD>
<TABLE id=idTableEch width="100%">
<TBODY>
<TR>
<TD class=TitreGroupeB colSpan=7 align=left>Echéances du compte cotisant </TD></TR>
<TR class=LibelleB2>
<TD>Echéance </TD>
<TD>NatFi</TD>
<TD>Calculé</TD>
<TD>Emis</TD>
<TD>Réglé</TD>
<TD>Solde global</TD>
<TD>Solde comptable</TD></TR>
<TR class=DonneeB2>
<TD>01/07/2017 </TD>
<TD></TD>
<TD align=right>1012.74 </TD>
<TD align=right>0.00 </TD>
<TD align=right>0.00 </TD>
<TD align=right>1012.74 </TD>
<TD align=right>0.00 </TD></TR>
<TR class=DonneeB2>
<TD>01/05/2017 </TD>
<TD></TD>
<TD align=right>337.58 </TD>
<TD align=right>0.00 </TD>
<TD align=right>0.00 </TD>
<TD align=right>337.58 </TD>
<TD align=right>0.00 </TD></TR>
<TR class=DonneeB2>
<TD>01/01/2017 </TD>
<TD></TD>
<TD align=right>225.16 </TD>
<TD align=right>225.16 </TD>
<TD align=right>225.16 </TD>
<TD align=right>0.00 </TD>
<TD align=right>0.00 </TD></TR>
<TR class=DonneeB2>
<TD>01/07/2016 </TD>
<TD></TD>
<TD align=right>306.06 </TD>
<TD align=right>306.06 </TD>
<TD align=right>306.06 </TD>
<TD align=right>0.00 </TD>
<TD align=right>0.00 </TD></TR>
<TR class=DonneeB2>
<TD>01/05/2016 </TD>
<TD></TD>
<TD align=right>102.02 </TD>
<TD align=right>102.02 </TD>
<TD align=right>102.02 </TD>
<TD align=right>0.00 </TD>
<TD align=right>0.00 </TD></TR></TBODY></TABLE></TD></TR>
<TR>
<TD>
<TABLE id=idTableCalc width="100%">
<TBODY>
<TR>
<TD class=LibelleB2>Calc : </TD>
<TD class=DonneeB2 align=right>1983.56 </TD>
<TD class=LibelleB2>Emis : </TD>
<TD class=DonneeB2 align=right>633.24 </TD>
<TD class=LibelleB2>Réglé : </TD>
<TD class=DonneeB2 align=right>633.24 </TD>
<TD class=LibelleB2>S. Glob. : </TD>
<TD class=DonneeB2 align=right>1350.32 </TD>
<TD class=LibelleB2>S. Compt. : </TD>
<TD class=DonneeB2 align=right>0.00 </TD></TR>
<TR>
<TD class=LibelleB2>Prime à émettre : </TD>
<TD class=DonneeB2 align=right>0.00 </TD>
<TD class=LibelleB2>&nbsp;</TD>
<TD class=DonneeB2>&nbsp;</TD>
<TD class=LibelleB2>&nbsp;</TD>
<TD class=DonneeB2>&nbsp;</TD>
<TD class=LibelleB2>&nbsp;</TD>
<TD class=DonneeB2>&nbsp;</TD>
<TD class=LibelleB2>Règl. att. :</TD>
<TD class=DonneeB2 align=right>0.00 </TD></TR></TBODY></TABLE></TD></TR><!-- tr>
     <td align="right">
	     
	     Validation du calcul :
	      <SELECT name="validation" id="nonbloque">
	          <OPTION></OPTION>
	          <OPTION value="OUI"  >Oui</OPTION>
	          <OPTION value="NON"  >Non</OPTION>
	      </SELECT>
	      
      </td>
      </tr --></TBODY></TABLE></FORM>
<SCRIPT type=text/javascript>var pageIsReloaded = true;</SCRIPT>

<SCRIPT language=JavaScript>
	if (document.forms[0].all["nbCompte"].value != 0) {
		MajLigne(document.forms[0].all["numeroCompte"].value,'listeCompte','img'+document.forms[0].all["numeroCompte"].value);
	}
</SCRIPT>
</DIV>
<SCRIPT>
//TT9031
//		heightcontenuFrame = (document.body.clientHeight);
//		var heightcontenuFrame = (document.body.clientHeight);
//		var obj = document.getElementById('contenu');
//		obj.style.height = heightcontenuFrame;
		//calculPlaceBoutons();
	</SCRIPT>
</DIV>
<SCRIPT language=JavaScript>
	
</SCRIPT>
<!-- Partie permettant la persistance du bandeau en cas d'erreur s'il existe -->
<SCRIPT language=JavaScript>
zzBlocageArbreAction();
function gestionRetourErreurBandeau()
{
	if(presenceBandeau=='true')
		gestionRetourPageErreur();
	var liste= document.forms;
	if(liste!=null)
	for(i=0;i<liste.length;i++)
		if(liste[i]!=null && liste[i]._zzToken_!=null)
			liste[i]._zzToken_.value='true';
}
</SCRIPT>
<IFRAME onload=JavaScript:gestionRetourErreurBandeau();appelUrl();appelUrlCalligo(); height=0 src="#" frameBorder=0 width=0 ?>
</IFRAME>
<META content=no-cache http-equiv=Pragma>
<META content=-1 http-equiv=Expires><INPUT id=notificationPluginShowError style="CURSOR: hand; HEIGHT: 23px; WIDTH: 23px; RIGHT: 2px; POSITION: absolute; DISPLAY: none; TOP: 2px; index: 9998" src="/Commun/multimedia/images/notification/error.png" type=image jQuery17109080263870954677="2"></INPUT></BODY></HTML>