<HTML><HEAD><TITLE>Web Aneto</TITLE>
<META name=GENERATOR content="IBM WebSphere Studio">
<META content=text/css http-equiv=Content-Style-Type><LINK rel=stylesheet type=text/css href="/Commun/style/Soltim.css"><LINK rel=stylesheet type=text/css href="/Commun/style/Container.css"><!-- Imports JQuery -->
<SCRIPT language=JavaScript src="/Commun/jquery/core/jquery.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/jquery/plugin/blockui/blockui.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/jquery/custom/block/block.js"></SCRIPT>
<!-- JqueryUI -->
<SCRIPT language=JavaScript src="/Commun/jquery/ui/jqueryui.js"></SCRIPT>
<LINK rel=stylesheet type=text/css href="/Commun/jquery/ui/jqueryui.css"><!-- Tooltip -->
<SCRIPT language=JavaScript src="/Commun/jquery/custom/tooltip/tooltip.js"></SCRIPT>
<!-- Notifications -->
<SCRIPT language=JavaScript src="/Commun/jquery/plugin/freeow/freeow.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/jquery/custom/notification/notification.js"></SCRIPT>
<LINK rel=stylesheet type=text/css href="/Commun/jquery/plugin/freeow/freeow.css"><!-- JqGrid (css) --><LINK rel=stylesheet type=text/css href="/Commun/jquery/plugin/jqgrid/jqgrid.css"><!-- Style la page avec JqueryUI -->
<SCRIPT language=JavaScript src="/Commun/js/jqueryuiApply.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/outils.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/container.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/grdo.js"></SCRIPT>
<!-- Import style infinite --><LINK rel=stylesheet type=text/css href="/Commun/style/infinite.css">
<SCRIPT language=javascript>

	<!-- Keep CONTAINER_NOM_SCENARIO_ENREGISTREMENT in JS variable -->
	var scenarioEnregistrement = "ACCC01STD_88";


/** 
	Variable indiquant si sur clic entrée on recherche un bouton suivant
	ou Rechercher apres ne pas avoir trouvé la fonction gestionToucheEntree().
	Pour cela mettre la variable a 1.
	Sinon metre 0 
*/
var ACTIVE_RECHERCHE = 0;


function InterceptEnter()
{ 
	var codeEntree = null;
	//Si exception c'est que la fonction n'existe pas.
	try
	{
		codeEntree = gestionToucheEntree();
		GestEnter(codeEntree);
	}
	
	catch(err)
	{
		if(ACTIVE_RECHERCHE == 1)
			GestEnter(codeEntree);
	}
	return true;
}
function GestEnter(codeEntree)
{
	var lienRecherche = null;
	var lienSuivant = null;
	var lien3PP = null;
	var nomZone = null;
	
	/**	Recherche si focus sur zone de recherche 3PP.
	* La bidouille consiste à trouver une image ayant un nom identique à la zone ayant le focus.
	* Exple: zone CodeFournisseur => recherche image ayant comme nom CodeFournisseur_IMG
	*/
	nomZone = document.activeElement.name;
	
	liste = document.getElementsByTagName("a");
	
	if(nomZone && codeEntree == null)
	{
		//Recherche lien 3PP sur la zone
		for(y=0;y<liste.length;y++)
		{
			if(liste[y].name == (nomZone + "_IMG"))
				lien3PP = liste[y];
		}
	}
	
	//si zone 3PP alors appel
	if(lien3PP!=null)
	{
		lien3PP.click();
		return true;
	}
	
	
	
	//Si action RECHERCHE ou non définie.
	if(codeEntree == null || codeEntree == "RECHERCHE")
	{
		for(y=0;y<liste.length;y++)
		{
			if(liste[y].title == "Rechercher" || liste[y].title == "Recherche")
				lienRecherche = liste[y];
		}
	}
	
	//si lien recherche présent alors click et sort
	if(lienRecherche!=null)
	{
		lienRecherche.click();
		return true;
	}
	
	//Si action SUIVANT ou non définie.
	if(codeEntree == null || codeEntree == "SUIVANT")
	{
		for(y=0;y<liste.length;y++)
		{
			if(liste[y].title == "Suivant")
				lienSuivant = liste[y];
		}
	}
	
	//si lien suivant présent alors click et sort
	if(lienSuivant!=null)
	{
		lienSuivant.click();
		return true;
	}
	
	return true;
}
</SCRIPT>

<SCRIPT language=JScript for=document type=text/jscript event=onkeydown()>
	whichASC = event.keyCode;
	try {
		raccourcisClavier();
	} catch(err) {
		if (whichASC == 13) InterceptEnter();
	}
</SCRIPT>

<SCRIPT language=JavaScript>


		// variable nous permettant de connaitre le nombre de boutons à afficher dans la fenêtre
		var boutons = 7;
		var fonction = 0;

/* Appel generique */
function appelGeneriqueFonction(methode)
{
	var cheminContexteWebapp = '/WebAneto';
	var nomFonction= 'ACEK';
	var nomFormulaire = 'acekForm';
	var chemin='/jsp/contrat/vue/ACEK.jsp';
	var temp = chemin.substring(5,chemin.length-4);
	var nomDomaine = temp.substring(0,temp.indexOf("/"));
	var nomMethode = "appelGenerique";
	var nomMethodeAppel = methode;
	var scenario='ACCC01STD_88';

	var parametreContainerObligatoire = "&CONTAINER_NOM_SCENARIO_ENREGISTREMENT="+scenario+"&CONTAINER_NOM_FONCTION="+nomFonction+"&AFFICHAGE_CONTAINER";

	appelGenerique(cheminContexteWebapp,
							nomFormulaire,nomDomaine,
							nomFonction,nomMethode,nomMethodeAppel,
							parametreContainerObligatoire)

}

function appelUrl()
{
	var url = 'null';
	if (!(url=="null" || url==""))
	{	
		//alert ( "TEST  = " + url);
		win=window.open(url,"ItSoft","");
		win.focus();
	 }
}


function appelUrlCalligo()
{
	var url = 'null';
	if (!(url=="null" || url==""))
	{	
		// on split d'abord l'url 
		var temp = url.split(";");
		// on boucle sur l'appel d'url 
		for(x=0;x<temp.length;x++){
			win=window.open(temp[x],"Calligo" + new Date().getTime(),"");
			win.focus();
		}
	}
}

//TT0016297
function appelUrlGED() {
	var url = 'null';
	if (url != "null") {
//INF0200
		win=window.open(url,"GED","");
		win.focus();
	}
}

/* Gestion des boutons MCR */
var bouton_valider="BOUTON_VALIDER";
var bouton_enregistrer="BOUTON_ENREGISTRER";
var bouton_miseEnInstance="BOUTON_MISE_EN_INSTANCE";
var bouton_fermer="BOUTON_FERMER";
var bouton_suivant="BOUTON_SUIVANT";
var bouton_precedent="BOUTON_PRECEDENT";
var bouton_initialiser="BOUTON_INITIALISER";
var bouton_declenche="";

//Gestion barre de statut et barre de titre.

var barre = '';
var titleJsp = '';

function assignebouton(bouton)
{
	bouton_declenche = '&BOUTON_CONTAINER=' + bouton;
}

function setTitreFenetre(titre)
{
	// Jean-Christophe MICHEL le 22/11/2007 : STAB2.2.1-BARRE-TITRE-02 : Début
	var libTitre = 'null';
	if (libTitre != null && libTitre != "" && libTitre != "null"){
		titre=libTitre+titre;
	}
	// Jean-Christophe MICHEL le 22/11/2007 : STAB2.2.1-BARRE-TITRE-02 : Fin

	//Nettoyage du titre ajouté.
	titleJsp = titre;
	parent.setTitreFenetre(titleJsp);
	return true;
}

function RAZTitreFenetre()
{
	titleJsp = '';
	parent.setTitreFenetre(parent.TITRE);
	return true;
}

function initBarreSatus(){
	//window.alert("initBarre");
	
	barre = "";
	
	setBarreStatus(barre);
	parent.defilement();	// TT0016252
}

function setBarreStatus(szBarre){
	barre = szBarre;
	parent.setBarreStatus(barre);
}
initBarreSatus();

/* fonction permettant l'interrogation de l'utilisateur sur la nécessité de sauvegarder la fonction courante
 retourne '0' S'il choisit Annuler
 retourne '6' S'il choisit Ok
 retourne '7' S'il choisit Non */
function validationVBScript()
{
	return window.showModalDialog('/WebAneto/jsp/container/vue/Confirmation.jsp','','dialogHeight: 130px; dialogWidth: 280px; center: Yes; help: No; resizable: No; status: No;');
}

/* fonction permettant l'interrogation de l'utilisateur sur la nécessité de sauvegarder l'acte de gestion
 retourne '0' S'il choisit Annuler
 retourne '6' S'il choisit Ok
 retourne '7' S'il choisit Non */
function enregistrementVBScript()
{
	return window.showModalDialog('/WebAneto/jsp/container/vue/ConfirmationActe.jsp','','dialogHeight: 130px; dialogWidth: 280px; center: Yes; help: No; resizable: No; status: No;');
}

//STAB221-SMP-008
//Fonction permettant l'appel de la boite de dialogue lors de la fermeture d'un acte en reprise d'instance
function enregistrementActeRepriseInstance()
{
	return window.showModalDialog('/WebAneto/jsp/container/vue/ConfirmationActeRepriseInstance.jsp','','dialogHeight: 200px; dialogWidth: 380px; center: Yes; help: No; resizable: No; status: No;');
}
//Fin STAB221-SMP-008

</SCRIPT>

<SCRIPT language=JavaScript>

/* ferme le scenario sans demander de confirmation à l'utilisateur */
function fermerContainerSansPopup() {
	zzModeForcageValidation = '1';
	posterFormulaire('LancementFonction','debuter','&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=11','');
}

/* Détermine le type de scénario
 zzScenarioForceContainer = '0' : Scénario courant en mode libre
 zzScenarioForceContainer = '1' : Scénario courant en mode forcé */
var zzScenarioForceContainer= '1';
/* Si scénario avec code action 03 : en visualisation */


//STAB221-SMP-008
//Code permettant de savoir si l'acte en cours a été ouvert via la reprise d'instance
var codeActionInitial = "";

//Fin STAB221-SMP-008

/* Permet de lancer la fermeture du container (NEW) */
function newFermerContainer(fonction,scenario)
{
	var isFonctionValidation = false;
	var codeAction = 01;
	
	// Si scénario forcé et l'acte n'est pas en mode visualisation
	// ANO => ED-V2.2.0-ACSO-02
	//if(zzScenarioForceContainer=='1' && zzModeEcranVisualisation=='0'&& (validation == 0 || isFonctionValidation == true))
	/*
		public final static String SCENARIO_CODE_ACTION_CREATION = "01";			==> on doit proposer l'enregistrement
		public final static String SCENARIO_CODE_ACTION_REPRISE_INSTANCE = "02";	==> on doit proposer l'enregistrement
		public final static String SCENARIO_CODE_ACTION_VISUALISATION = "03";		==> on NE doit PAS proposer l'enregistrement
		public final static String SCENARIO_CODE_ACTION_SANS_EFFET = "04";			==> on NE doit PAS proposer l'enregistrement
	*/
	if (zzScenarioForceContainer=='1' && zzModeEcranVisualisation=='0'&& (codeAction != 3  || isFonctionValidation == true))
	{
			// On interroge l'utilisateur s'il veut sauvegarder l'acte
			
			//STAB221-SMP-008
			var userChoise ="";
			if(codeActionInitial == "02"){
				//Si l'acte a été ouvert en reprise d'instance
				userChoise = enregistrementActeRepriseInstance();
			}else{
				userChoise = enregistrementVBScript();
			}
			//Fin STAB221-SMP-008
			
			// Cas ou il veut le sauvegarder
			if(userChoise == '6')
				newLancerFonction('LancementFonction','debuter',fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=1',scenario);
		
			// On sort si l'utilisateur a fait un choix différent de ne pas sauvegarder l'acte
			if(userChoise!='7')
				return;
			// Rajout MCR le 29/11 ano SCE_WEB_SOCLE_001
			if (userChoise == '7'){
				
				setBarreStatus("");
				zzModeForcageValidation = 1;
			}
	}
	else {
		
		userChoice = newInterrogerClientSurValidation();
		if (userChoice == '0') 
			return;
		if (zzModeForcageValidation == '2') {
			// Scénario libre avec sauvegarde
			posterFormulaire('LancementFonction', 'debuter', fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=12', scenario);
			return;
		}
	}
	posterFormulaire('LancementFonction','debuter',fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=11',scenario);

}
/* Postage d'un lancement de fonction */
function posterFormulaire(mapping,methode,fonction,scenario)
{

	if(scenario=='')
			scenario='ACCC01STD_88';
	var actionValue= '/WebAneto/container/'+mapping+'.do?method='+methode
						+'&CONTAINER_NOM_SCENARIO_ENREGISTREMENT='+scenario+'&CONTAINER_NOM_FONCTION='
						+fonction ;
	basiquePosterFormulaire(scenario,actionValue);

}
/* Postage d'un lancement de fonction scénario */
function posterFormulaireScenario(mapping,methode,scenario)
{

		var scenarioCourant='ACCC01STD_88';
		var actionValue= '/WebAneto/container/'+mapping+'.do?method='+methode
							+'&CONTAINER_NOM_SCENARIO_ENREGISTREMENT='+scenarioCourant+'&CONTAINER_NOM_SCENARIO_FILS='
							+scenario ;

		basiquePosterFormulaire(scenario,actionValue);

}
//MAC_154425 : formulaireDejaPoste : éviter que l'utilisateur ne puisse cliquer plusieurs fois sur les boutons (Christophe RAYMOND)
var formulaireDejaPoste = false;
/* Postage d'un lancement basique */
function basiquePosterFormulaire(scenario,actionValue)
{
	if (formulaireDejaPoste == false) {
	//Suppr MAC_20061102_1244_RKO01 : ligne descendue
	//formulaireDejaPoste = true;
	var i=0;
	var affichageContainer='&AFFICHAGE_CONTAINER=OK';

	var nameFormFonctionSpecification='acekForm';
	if(document.forms.length>0)
	{
		var documentFormObject=document.forms[0];
		if(document.forms[nameFormFonctionSpecification]!=null)
			documentFormObject=document.forms[nameFormFonctionSpecification];
		
		if(documentFormObject.onsubmit!=null)
		{
			if(documentFormObject.onsubmit()!=false)
				i=1;
		}
		else i=1;

			
		if(i==1)
		{
			actionValue=actionValue + affichageContainer;
			// Ajout Michel pour gestion des boutons
			actionValue=actionValue + bouton_declenche;
			if(zzModeForcageValidation == '1' || (zzModeForcageValidation == '0' && forcageFonctionContainer=='true'))
				actionValue = actionValue+'&CONTAINER_FONCTION_FORCAGE_VALIDATION=FALSE';

			documentFormObject.action=actionValue;
			//Ajout MAC_20061102_1244_RKO01 : ligne descendue
			formulaireDejaPoste = true;
			nePasModifierForcageValidation='false';
			documentFormObject.submit();
		}
	}
	else window.location="/WebAneto/container/LancementScenario.do?method=debuter&CONTAINER_NOM_SCENARIO_ENREGISTREMENT="+ scenario + affichageContainer;
	}
}


/******************** DEBUT ANCIEN FONCTIONNEMENT **************************/
var valideFonctionCouranteContainer;
var forcageFonctionContainer='false';
var presenceBandeau='false';
function ancienFermerContainer(fonction,scenario)
{
		// Cas d'un acte de gestion en mode visualisation
		
		zzValidation='1';
		
		if(zzScenarioForceContainer=='1' && zzValidation=='1')
		{
			valideFonctionCouranteContainer=enregistrementVBScript();
			if(valideFonctionCouranteContainer!=null)
				{
					if(valideFonctionCouranteContainer=='6')
					{
						ancienLancerFonction('LancementFonction','debuter',fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=1',scenario);
					}
					if(valideFonctionCouranteContainer=='7')
					{
						forcageFonctionContainer='true';
						posterFormulaire('LancementFonction','debuter',fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=11',scenario);
					}
				}
		}
		else
		{
			forcageFonctionContainer='true';
			posterFormulaire('LancementFonction','debuter',fonction+'&CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=11',scenario);
		}
}
function ancienLancerFonction(mapping,methode,fonction,scenario)
{
	if(zzBlocageArbreVar=='false')
	{
		// Cas d'un acte de gestion en mode visualisation
		
		if(forcageFonctionContainer=='true')
		{
			posterFormulaire(mapping,methode,fonction,scenario);
		}
		else
		{
			valideFonctionCouranteContainer=validationVBScript();
			if(valideFonctionCouranteContainer!=null)
			{
				if(valideFonctionCouranteContainer=='6')
				{
					posterFormulaire(mapping,methode,fonction,scenario);
				}
				if(valideFonctionCouranteContainer=='7')
				{
					forcageFonctionContainer='true'
					posterFormulaire(mapping,methode,fonction,scenario);
				}
			}
		}
	}

}

function ancienLancerFonctionScenario(mapping,methode,scenario)
{
	if(zzBlocageArbreVar=='false')
	{
		// Cas d'un acte de gestion en mode visualisation
		
		if(forcageFonctionContainer=='true')
		{
			posterFormulaireScenario(mapping,methode,scenario);
		}
		else
		{
			valideFonctionCouranteContainer=validationVBScript();
			if(valideFonctionCouranteContainer!=null)
			{
				if(valideFonctionCouranteContainer=='6')
				{
					posterFormulaireScenario(mapping,methode,scenario);
				}
				if(valideFonctionCouranteContainer=='7')
				{
					forcageFonctionContainer='true'
					posterFormulaireScenario(mapping,methode,scenario);
				}
			}
		}
	}
}
/******************** FIN ANCIEN FONCTIONNEMENT **************************/
</SCRIPT>
</HEAD>
<BODY id=containerBody onload="javascript:initialiser();lockChamps('2','01','1')" leftMargin=0 topMargin=0 bgColor=#ffffff>
<DIV id=notification class="freeow freeow-top-right" jQuery17105285885181812099="4"></DIV><!-- Affichage des boutons de navigation   --><!-- Affichage des boutons de navigation autre que Fermer   --><!-- Affichage des boutons de navigation   --><!-- Affichage des boutons de navigation autre que Fermer   --><!-- Affichage des boutons de navigation   --><!-- Affichage des boutons de navigation autre que Fermer   --><!-- Affichage des boutons de navigation   --><!-- Affichage des boutons de navigation autre que Fermer   --><!-- Affichage des boutons de navigation   --><!-- Affichage des boutons de navigation autre que Fermer   --><!-- Affichage des boutons de navigation   --><!-- Gestion des groupes de données 
	 Michel Crumière le 29/12/2005-->
<SCRIPT language=JavaScript>


</SCRIPT>

<DIV id=Container jQuery17105285885181812099="3">
<DIV id=arbreContainer>
<DIV id=scenario style="HEIGHT: 541px"><!-- Identifiant scénario pour injecteur --><INPUT type=hidden value=ACCC01STD_88 name=zz_NomScenario>
<SCRIPT language=JavaScript src="/Commun/js/arbreNC.js">
</SCRIPT>

<SCRIPT language=JavaScript>

// Java script composant l'arbre

USETEXTLINKS = 1
STARTALLOPEN = 0
USEFRAMES = 0
USEICONS = 1
WRAPTEXT = 0
PERSERVESTATE = 1
ICONPATH="/Commun/multimedia/images/arbre/"
NODEIDTODEPLOY = 'empty';

//FGA : Tableau pour occultation arbre (boutons fonctions du container)
TABLIEN = new Array(Array)
TABLIEN[0][0] = "Valider";
TABLIEN[1] = new Array(Array);
//NC1472617 : Mise en phase avec l'id du bouton "Reinitialiser" de la jsp NavigationNC pour une gestion correcte de son affichage (s'appuie sur l'id "lien"+nom_bouton).
TABLIEN[1][0] = "Reinit";
TABLIEN[2] = new Array(Array);
TABLIEN[2][0] = "Precedent";
TABLIEN[3] = new Array(Array);
TABLIEN[3][0] = "Suivant";
TABLIEN[4] = new Array(Array);
TABLIEN[4][0] = "MEI";
TABLIEN[5] = new Array(Array);
TABLIEN[5][0] = "Enregistrer";
		
foldersTree = gFld('Chgt couverture', '#','','s3');
foldersTree.xID = 'ACCC01STD_88';

				 aux1 = insFld(foldersTree, gFld('Ident contrat', 'JavaScript:lancerFonction("LancementFonction","debuter","ACIC_100","ACCC01STD_88");','18','s4'));
				 aux1.xID = 'ACIC_100ACCC01STD_88';
				
				 aux1 = insFld(foldersTree, gFld('Bloc-notes CI', 'JavaScript:lancerFonction("LancementFonction","debuter","ACBN_200","ACCC01STD_88");','18','s4'));
				 aux1.xID = 'ACBN_200ACCC01STD_88';
				
				 aux1 = insFld(foldersTree, gFld('Produits/GT', 'JavaScript:lancerFonction("LancementFonction","debuter","ACPG_300","ACCC01STD_88");','18','s4'));
				 aux1.xID = 'ACPG_300ACCC01STD_88';
				
							aux2 =insFld(aux1, gFld('Attest. Aide CS', 'JavaScript:lancerFonction("LancementFonction","debuter","ACAC_301","ACCC01STD_88");','6','s4'));
							aux2.xID = 'ACAC_301ACCC01STD_88';

						
							aux2 =insFld(aux1, gFld('Crit souscript', 'JavaScript:lancerFonction("LancementFonction","debuter","ACCS_302","ACCC01STD_88");','6','s4'));
							aux2.xID = 'ACCS_302ACCC01STD_88';

						
							aux2 =insFld(aux1, gFld('Modulation com.', 'JavaScript:lancerFonction("LancementFonction","debuter","ACMC_303","ACCC01STD_88");','6','s4'));
							aux2.xID = 'ACMC_303ACCC01STD_88';

						
							aux2 =insFld(aux1, gFld('Garanties dérog', 'JavaScript:lancerFonction("LancementFonction","debuter","ACGD_304","ACCC01STD_88");','6','s4'));
							aux2.xID = 'ACGD_304ACCC01STD_88';

						
							aux2 =insFld(aux1, gFld('Dérog commerc', 'JavaScript:lancerFonction("LancementFonction","debuter","ACDC_305","ACCC01STD_88");','6','s4'));
							aux2.xID = 'ACDC_305ACCC01STD_88';

						
				 aux1 = insFld(foldersTree, gFld('Param divers', 'JavaScript:lancerFonction("LancementFonction","debuter","ACPD_400","ACCC01STD_88");','12','s4'));
				 aux1.xID = 'ACPD_400ACCC01STD_88';
				
				 aux1 = insFld(foldersTree, gFld('Re-gén. Résil', '#','13','s4'));
				 aux1.xID = 'ACRR_500ACCC01STD_88';
				
				 aux1 = insFld(foldersTree, gFld('Param.calc.', 'JavaScript:lancerFonction("LancementFonction","debuter","AC32_600","ACCC01STD_88");','18','s4'));
				 aux1.xID = 'AC32_600ACCC01STD_88';
				
				 aux1 = insFld(foldersTree, gFld('Histo. cotis.', 'JavaScript:lancerFonction("LancementFonction","debuter","AC3Q_700","ACCC01STD_88");','18','s4'));
				 aux1.xID = 'AC3Q_700ACCC01STD_88';
				
				 aux1 = insFld(foldersTree, gFld('Visu. cpt cotis', 'JavaScript:lancerFonction("LancementFonction","debuter","AC36_800","ACCC01STD_88");','18','s4'));
				 aux1.xID = 'AC36_800ACCC01STD_88';
				
				 aux1 = insFld(foldersTree, gFld('Avis éch immed', 'JavaScript:lancerFonction("LancementFonction","debuter","AC3U_900","ACCC01STD_88");','18','s4'));
				 aux1.xID = 'AC3U_900ACCC01STD_88';
				
						NODEIDTODEPLOY = ('ACEK_1000ACCC01STD_88');
					
				 aux1 = insFld(foldersTree, gFld('Cartes TP imméd', 'JavaScript:lancerFonction("LancementFonction","debuter","ACEK_1000","ACCC01STD_88");','18','s5'));
				 aux1.xID = 'ACEK_1000ACCC01STD_88';
				
				 aux1 = insFld(foldersTree, gFld('Validation acte', '#','19','s4'));
				 aux1.xID = 'ACVV_1100ACCC01STD_88';
				
				 aux1 = insFld(foldersTree, gFld('Editique', '#','19','s4'));
				 aux1.xID = 'F020_1200ACCC01STD_88';
				

// Fonction Javascript permettant le blocage de tous les liens de l'arbre

function blocageArbre(blocage)
{
	zzBlocageArbreVar=blocage;	
	zzBlocageArbreActiveVar='true';
	zzBlocageArbreAction();
	
}
function zzBlocageArbreAction()
{
	if(zzBlocageArbreActiveVar=='true')
	{
		listhref= document.getElementsByTagName("a");
		
		for(i=0;i!=listhref.length;i++)
			{
				if(listhref[i].id.substring(0,18) == 'itemDrawFolderLink'
				|| listhref[i].id.substring(0,12) == 'itemTextLink'
				|| listhref[i].id.substring(0,18) == 'itemFolderHTMLLink'
				|| listhref[i].id.substring(0,12) == 'itemIconLink')
				{
					if(zzBlocageArbreVar=='true')
						listhref[i].disabled=true;
					else listhref[i].disabled=false;
				}
			}
		
		//FGA:Blocage des boutons du container + image grisé + curseur sans main
		for(i=0;i<TABLIEN.length;i++)
		{
			objLink = document.getElementById("lien"+TABLIEN[i][0]);
			objImg = document.getElementById("bt"+TABLIEN[i][0]);
			if(objLink && objImg)
			{
				if(zzBlocageArbreVar=='true')
				{
					TABLIEN[i][1] = objLink.href;
					objLink.href = '#';
					//Image du bouton grisée + curseur sans main +sav href et mouseover.
					objImg.style.filter = "alpha(opacity=30)"; 
					TABLIEN[i][2] = objImg.onmouseover; 
					objImg.onmouseover ='';
					objImg.style.cursor = "default";					
				}
				else
				{
					if(TABLIEN[i][1] && TABLIEN[i][1]!="")
						objLink.href = TABLIEN[i][1];
					objImg.style.filter = "alpha(opacity=100)";
					if(TABLIEN[i][2] && TABLIEN[i][2]!="")
						objImg.onmouseover =  TABLIEN[i][2]; 
					objImg.style.cursor = "auto";
				}
			}
		}
	}
}

function goFocusScroll() {
	if (document.getElementById("scrolltop").value != null) {
		val = document.getElementById('scrolltop').value;
		document.getElementById('scenario').scrollTop = val;
	}		
	//-- Ajout LPI
	goFocusArbre();
	//-- Fin LPI
}

function goFocusArbre() {
	if (document.getElementById("folderSel").value != null) {
		noSel = document.getElementById("folderSel").value;
		if (document.getElementById("itemTextLink"+noSel) != null) {
			$("#itemTextLink"+noSel).focus();
		}			
	}	
}

</SCRIPT>
 <INPUT id=folderSel type=hidden value=15 length="4"> <INPUT id=scrolltop type=hidden length="4"> 
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR vAlign=top>
<TD colSpan=2>
<TABLE cellSpacing=0 cellPadding=5 width="100%" border=0>
<TBODY>
<TR>
<TD>
<SCRIPT language=Javascript>initializeDocument(NODEIDTODEPLOY);</SCRIPT>

<DIV id=domRoot>
<DIV id=folder0 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre0></A>
<TBODY>
<TR>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACCC01STD_88","0", false)' id=itemFolderHTMLLink class=s3 href="http://infinite-haur05/WebAneto/container/LancementFonction.do?method=debuter&amp;CONTAINER_NOM_SCENARIO_ENREGISTREMENT=ACCC01STD_88&amp;CONTAINER_NOM_FONCTION=ACEK_1000&amp;AFFICHAGE_CONTAINER=OK&amp;BOUTON_CONTAINER=BOUTON_SUIVANT#"><IMG id=folderIcon0 border=0 name=folderIcon0 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap>
<DIV class=s3>Chgt couverture</DIV></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder1 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre1></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACIC_100ACCC01STD_88")'><IMG id=nodeIcon1 border=0 name=nodeIcon1 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACIC_100ACCC01STD_88","1", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACIC_100","ACCC01STD_88");'><IMG id=folderIcon1 border=0 name=folderIcon1 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACIC_100ACCC01STD_88","1", false)' id=itemTextLink1 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACIC_100","ACCC01STD_88");'>Ident contrat</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder2 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre2></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACBN_200ACCC01STD_88")'><IMG id=nodeIcon2 border=0 name=nodeIcon2 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACBN_200ACCC01STD_88","2", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACBN_200","ACCC01STD_88");'><IMG id=folderIcon2 border=0 name=folderIcon2 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACBN_200ACCC01STD_88","2", false)' id=itemTextLink2 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACBN_200","ACCC01STD_88");'>Bloc-notes CI</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder3 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre3></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACPG_300ACCC01STD_88")'><IMG id=nodeIcon3 border=0 name=nodeIcon3 src="/Commun/multimedia/images/arbre/ftv2mnode.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACPG_300ACCC01STD_88","3", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACPG_300","ACCC01STD_88");'><IMG id=folderIcon3 border=0 name=folderIcon3 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACPG_300ACCC01STD_88","3", false)' id=itemTextLink3 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACPG_300","ACCC01STD_88");'>Produits/GT</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder4 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre4></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><IMG src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2vertline.gif" width=16 height=22></TD>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACAC_301ACCC01STD_88")'><IMG id=nodeIcon4 border=0 name=nodeIcon4 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACAC_301ACCC01STD_88","4", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACAC_301","ACCC01STD_88");'><IMG id=folderIcon4 border=0 name=folderIcon4 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier6.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACAC_301ACCC01STD_88","4", false)' id=itemTextLink4 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACAC_301","ACCC01STD_88");'>Attest. Aide CS</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder5 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre5></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><IMG src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2vertline.gif" width=16 height=22></TD>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACCS_302ACCC01STD_88")'><IMG id=nodeIcon5 border=0 name=nodeIcon5 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACCS_302ACCC01STD_88","5", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACCS_302","ACCC01STD_88");'><IMG id=folderIcon5 border=0 name=folderIcon5 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier6.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACCS_302ACCC01STD_88","5", false)' id=itemTextLink5 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACCS_302","ACCC01STD_88");'>Crit souscript</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder6 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre6></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><IMG src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2vertline.gif" width=16 height=22></TD>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACMC_303ACCC01STD_88")'><IMG id=nodeIcon6 border=0 name=nodeIcon6 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACMC_303ACCC01STD_88","6", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACMC_303","ACCC01STD_88");'><IMG id=folderIcon6 border=0 name=folderIcon6 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier6.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACMC_303ACCC01STD_88","6", false)' id=itemTextLink6 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACMC_303","ACCC01STD_88");'>Modulation com.</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder7 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre7></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><IMG src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2vertline.gif" width=16 height=22></TD>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACGD_304ACCC01STD_88")'><IMG id=nodeIcon7 border=0 name=nodeIcon7 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACGD_304ACCC01STD_88","7", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACGD_304","ACCC01STD_88");'><IMG id=folderIcon7 border=0 name=folderIcon7 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier6.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACGD_304ACCC01STD_88","7", false)' id=itemTextLink7 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACGD_304","ACCC01STD_88");'>Garanties dérog</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder8 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre8></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><IMG src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2vertline.gif" width=16 height=22></TD>
<TD vAlign=top><A id=itemDrawFolderLink href='javascript:clickOnNode("ACDC_305ACCC01STD_88")'><IMG id=nodeIcon8 border=0 name=nodeIcon8 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2lastnode.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACDC_305ACCC01STD_88","8", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACDC_305","ACCC01STD_88");'><IMG id=folderIcon8 border=0 name=folderIcon8 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier6.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACDC_305ACCC01STD_88","8", false)' id=itemTextLink8 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACDC_305","ACCC01STD_88");'>Dérog commerc</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder9 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre9></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACPD_400ACCC01STD_88")'><IMG id=nodeIcon9 border=0 name=nodeIcon9 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACPD_400ACCC01STD_88","9", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACPD_400","ACCC01STD_88");'><IMG id=folderIcon9 border=0 name=folderIcon9 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier12.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACPD_400ACCC01STD_88","9", false)' id=itemTextLink9 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","ACPD_400","ACCC01STD_88");'>Param divers</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder10 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre10></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACRR_500ACCC01STD_88")'><IMG id=nodeIcon10 border=0 name=nodeIcon10 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACRR_500ACCC01STD_88","10", false)' id=itemFolderHTMLLink class=s4 href="http://infinite-haur05/WebAneto/container/LancementFonction.do?method=debuter&amp;CONTAINER_NOM_SCENARIO_ENREGISTREMENT=ACCC01STD_88&amp;CONTAINER_NOM_FONCTION=ACEK_1000&amp;AFFICHAGE_CONTAINER=OK&amp;BOUTON_CONTAINER=BOUTON_SUIVANT#"><IMG id=folderIcon10 border=0 name=folderIcon10 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier13.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap>
<DIV class=s4>Re-gén. Résil</DIV></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder11 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre11></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("AC32_600ACCC01STD_88")'><IMG id=nodeIcon11 border=0 name=nodeIcon11 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("AC32_600ACCC01STD_88","11", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC32_600","ACCC01STD_88");'><IMG id=folderIcon11 border=0 name=folderIcon11 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("AC32_600ACCC01STD_88","11", false)' id=itemTextLink11 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC32_600","ACCC01STD_88");'>Param.calc.</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder12 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre12></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("AC3Q_700ACCC01STD_88")'><IMG id=nodeIcon12 border=0 name=nodeIcon12 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("AC3Q_700ACCC01STD_88","12", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC3Q_700","ACCC01STD_88");'><IMG id=folderIcon12 border=0 name=folderIcon12 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("AC3Q_700ACCC01STD_88","12", false)' id=itemTextLink12 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC3Q_700","ACCC01STD_88");'>Histo. cotis.</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder13 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre13></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("AC36_800ACCC01STD_88")'><IMG id=nodeIcon13 border=0 name=nodeIcon13 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("AC36_800ACCC01STD_88","13", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC36_800","ACCC01STD_88");'><IMG id=folderIcon13 border=0 name=folderIcon13 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("AC36_800ACCC01STD_88","13", false)' id=itemTextLink13 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC36_800","ACCC01STD_88");'>Visu. cpt cotis</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder14 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre14></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("AC3U_900ACCC01STD_88")'><IMG id=nodeIcon14 border=0 name=nodeIcon14 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("AC3U_900ACCC01STD_88","14", false)' id=itemFolderHTMLLink class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC3U_900","ACCC01STD_88");'><IMG id=folderIcon14 border=0 name=folderIcon14 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("AC3U_900ACCC01STD_88","14", false)' id=itemTextLink14 class=s4 href='javascript:lancerFonction("LancementFonction","debuter","AC3U_900","ACCC01STD_88");'>Avis éch immed</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder15 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre15></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACEK_1000ACCC01STD_88")'><IMG id=nodeIcon15 border=0 name=nodeIcon15 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACEK_1000ACCC01STD_88","15", false)' id=itemFolderHTMLLink class=s5 href='javascript:lancerFonction("LancementFonction","debuter","ACEK_1000","ACCC01STD_88");'><IMG id=folderIcon15 border=0 name=folderIcon15 src="/Commun/multimedia/images/arbre/Dossier18.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap><A onclick='javascript:clickOnFolder("ACEK_1000ACCC01STD_88","15", false)' id=itemTextLink15 class=s5 href='javascript:lancerFonction("LancementFonction","debuter","ACEK_1000","ACCC01STD_88");'>Cartes TP imméd</A></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder16 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre16></A>
<TBODY>
<TR>
<TD vAlign=top background=/Commun/multimedia/images/arbre/ftv2vertline.gif><A id=itemDrawFolderLink href='javascript:clickOnNode("ACVV_1100ACCC01STD_88")'><IMG id=nodeIcon16 border=0 name=nodeIcon16 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2node.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("ACVV_1100ACCC01STD_88","16", false)' id=itemFolderHTMLLink class=s4 href="http://infinite-haur05/WebAneto/container/LancementFonction.do?method=debuter&amp;CONTAINER_NOM_SCENARIO_ENREGISTREMENT=ACCC01STD_88&amp;CONTAINER_NOM_FONCTION=ACEK_1000&amp;AFFICHAGE_CONTAINER=OK&amp;BOUTON_CONTAINER=BOUTON_SUIVANT#"><IMG id=folderIcon16 border=0 name=folderIcon16 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier19.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap>
<DIV class=s4>Validation acte</DIV></TD></TR></TBODY></TABLE></DIV>
<DIV id=folder17 style="DISPLAY: block">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0><A id=ligneArbre17></A>
<TBODY>
<TR>
<TD vAlign=top><A id=itemDrawFolderLink href='javascript:clickOnNode("F020_1200ACCC01STD_88")'><IMG id=nodeIcon17 border=0 name=nodeIcon17 src="http://infinite-haur05/Commun/multimedia/images/arbre/ftv2lastnode.gif" width=16 height=22></A></TD>
<TD vAlign=top><A onclick='javascript:clickOnFolder("F020_1200ACCC01STD_88","17", false)' id=itemFolderHTMLLink class=s4 href="http://infinite-haur05/WebAneto/container/LancementFonction.do?method=debuter&amp;CONTAINER_NOM_SCENARIO_ENREGISTREMENT=ACCC01STD_88&amp;CONTAINER_NOM_FONCTION=ACEK_1000&amp;AFFICHAGE_CONTAINER=OK&amp;BOUTON_CONTAINER=BOUTON_SUIVANT#"><IMG id=folderIcon17 border=0 name=folderIcon17 src="http://infinite-haur05/Commun/multimedia/images/arbre/Dossier19.gif"></A></TD>
<TD vAlign=middle width="100%" noWrap>
<DIV class=s4>Editique</DIV></TD></TR></TBODY></TABLE></DIV></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<SCRIPT language=JavaScript>
	if (document.getElementById("folderSel").value != null) {
		noSel = document.getElementById("folderSel").value;

		// -- Modif LPI du 15/12/2010	
		//nbFn = 20;
		hauteurDiv = document.getElementById("scenario").offsetHeight;
		hauteurFolder = document.getElementById("itemDrawFolderLink").offsetHeight;
		valeur = hauteurDiv / hauteurFolder;
		nbFn = Math.ceil(valeur);
		// -- Fin LPI

		val = document.getElementById('scrolltop').value;
		if (noSel < nbFn) {
			goFocusArbre();
		} else {	
			goFocusScroll();
		}
	}	
</SCRIPT>
</DIV>
<DIV id=zonebouton style="HEIGHT: 259px">
<DIV id=bouton>
<SCRIPT language=JavaScript>
		// Ajout SCE_ZZWEB_004
		var tabFonctions = new Array();
	</SCRIPT>

<DIV id=boutonFonction><A href="JavaScript:gestionBoutonFonction();"><IMG onmouseover="javascript:afficheBoutonOn('btFonction','128');" onmouseout="javascript:afficheBoutonOff('btFonction','128');" id=btFonction title=Fonction border=0 src="/Commun/multimedia/images/container/128.gif"></A> </DIV>
<DIV id=boutGestBoutonFonction class=divColor style="HEIGHT: 8px; WIDTH: 100px; POSITION: absolute; LEFT: 160px; DISPLAY: none; TOP: 283px">
<DIV></DIV></DIV>
<DIV id=gestBoutonFonction class=divColor style="HEIGHT: 15px; POSITION: absolute; LEFT: 190px; Z-INDEX: 200; DISPLAY: none; TOP: 563px"><IFRAME style="HEIGHT: 20px; WIDTH: 150px; POSITION: absolute; LEFT: 0px; FILTER: mask(); Z-INDEX: -1; DISPLAY: block; TOP: 0px"></IFRAME>
<TABLE cellSpacing=0 cellPadding=0 width=150 border=0>
<TBODY>
<TR>
<TD width="100%"><A class=S3 href="javascript:posterFormulaire('LancementFonction', 'debuter', 'AC3U_900&amp;CONTAINER_FONCTION_FORCAGE_VALIDATION=FALSE', 'ACCC01STD_88');"><B>&nbsp;&nbsp;Abandonner</B></A><BR></TD></TR></TBODY></TABLE></DIV><!-- Affichage du boutons de navigation Précédent -->
<DIV id=boutonPrecedent><A id=lienPrecedent title=Précédent href="JavaScript:assignebouton(bouton_precedent);lancerFonction('LancementFonction','debuter','AC3U_900','ACCC01STD_88','0');"><IMG onmouseover="javascript:afficheBoutonOn('btPrecedent','107');" onmouseout="javascript:afficheBoutonOff('btPrecedent','107');" id=btPrecedent border=0 src="/Commun/multimedia/images/container/107.gif"></A> </DIV><!-- Affichage du bouton de navigation Suivant --><!-- DEBUT ED-V2.2.0-GRC-001 -->
<DIV id=boutonSuivant><A id=lienSuivant title=Suivant href="JavaScript:assignebouton(bouton_suivant);posterFormulaire('LancementFonction','debuter','ACVV_1100','ACCC01STD_88');"><IMG onmouseover="javascript:afficheBoutonOn('btSuivant','121');" onmouseout="javascript:afficheBoutonOff('btSuivant','121');" id=btSuivant border=0 src="/Commun/multimedia/images/container/121.gif"></A> </DIV><!-- FIN ED-V2.2.0-GRC-001 --><!-- Affichage du boutons de navigation Enregistrer  --><!-- DEBUT ED-V2.2.0-PSCD-001 -->
<SCRIPT>boutons = boutons + 1;</SCRIPT>
<!-- Affichage du boutons de navigation Enregistrer  -->
<DIV id=boutonEnregistrer><A id=lienEnregistrer title=Enregistrer href="JavaScript:assignebouton(bouton_enregistrer);lancerFonction('LancementFonction','debuter','ACVV_1100&amp;CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=9','ACCC01STD_88');"><IMG onmouseover="javascript:afficheBoutonOn('btEnregistrer','125');" onmouseout="javascript:afficheBoutonOff('btEnregistrer','125');" id=btEnregistrer border=0 src="/Commun/multimedia/images/container/125.gif"></A> </DIV><!-- FIN ED-V2.2.0-PSCD-001 --><!-- Affichage du boutons de navigation Mis en instance  -->
<DIV id=boutonMiseEnInstance><A id=lienMEI title="Mise en inst." href="JavaScript:assignebouton(bouton_miseEnInstance);lancerFonction('LancementFonction','debuter','ACVV_1100&amp;CONTAINER_MODE_EXECUTION_VALIDATION_SCENARIO=10','ACCC01STD_88');"><IMG onmouseover="javascript:afficheBoutonOn('btMEI','123');" onmouseout="javascript:afficheBoutonOff('btMEI','123');" id=btMEI border=0 src="/Commun/multimedia/images/container/123.gif"></A> </DIV><!-- DEBUT AC_ZZ_STAB221_001 
		Affichage du bouton réinitialiser au dessus du bouton fermer
	--><!-- Affichage du boutons de navigation Reinitialiser -->
<DIV id=boutonReinit><A id=lienReinit href="Javascript:posterFormulaire('LancementFonction','debuter','ACEK_1000&amp;CONTAINER_FONCTION_FORCAGE_VALIDATION=FALSE&amp;BOUTON_CONTAINER=BOUTON_INITIALISER','ACCC01STD_88');"><IMG onmouseover="javascript:afficheBoutonOn('btReinit','202');" onmouseout="javascript:afficheBoutonOff('btReinit','202');" id=btReinit title=Réinitialiser border=0 src="/Commun/multimedia/images/container/202.gif"> </A></DIV><!-- FIN AC_ZZ_STAB221_001 --><!-- Affichage du bouton d'aide -->
<DIV id=boutonAide><A id=lienAide href="JavaScript:openHelp();"><IMG onmouseover="javascript:afficheBoutonOn('btAide','129');" onmouseout="javascript:afficheBoutonOff('btAide','129');" id=btAide title=Aide border=0 src="/Commun/multimedia/images/container/129.gif"></A> </DIV><!-- Affichage du boutons de navigation Fermer -->
<DIV id=boutonFermer><A id=lienFermer href="JavaScript:assignebouton(bouton_fermer);fermerContainer('ACVV_1100','ACCC01STD_88');"><IMG onmouseover="javascript:afficheBoutonOn('btFermer','127');" onmouseout="javascript:afficheBoutonOff('btFermer','127');" id=btFermer title=Fermer border=0 src="/Commun/multimedia/images/container/127.gif"></A> </DIV>
<SCRIPT language=JavaScript src="/Commun/js/aide.js"></SCRIPT>

<SCRIPT language=JavaScript>
	
	/****************************************************************
	* Fonctions liées au bouton Fonction.
	* Ajout, supression de fonctions secondaires.
	* Calcul placement des boutons.
	****************************************************************/
		function trim (chaine) {
 			chaine = unescape(chaine);
			 return chaine.replace(/(^\s*)|(\s*$)/g, "");
		}
	
		var htmlFonction = "";
		var nomForm = '';
		var nomFonction= 'ACEK';
	
		var libelle = '';
		var parametre1 = '';
		var parametre2 = '';
		var action2 = '';
		var action = '';
		var scenar = 'ACCC01STD_88';
        var contextPath = '/WebAneto';
		
		// Début Ajout SCE_ZZWEB_004
		fonction = 0;
		tabFonctions = new Array();
		// Fin Ajout SCE_ZZWEB_004
		

		// Fonction ajoutée pour SCE_ZZWEB_004
		function _reaffichageMenu() {
			var htmlFonction = '';
			if (fonction > 0) { 
				var hIframe = (15*fonction) + 5;
				htmlFonction += '<iframe style="{display:block;position:absolute;top:0;left:0;z-index:-1;filter:mask();width:150px;height:'+hIframe+';}"></iframe>';
				htmlFonction += '<table border="0" width="150px" cellspacing="0" cellpadding="0"><tr><td width="100%">';
				for(var i = 0; i < fonction; i++) {
					if (tabFonctions[i][1]=="MO" || tabFonctions[i][1]=="VI") {
						htmlFonction += tabFonctions[i][2];
					}
				}
				htmlFonction += '</td></tr></table>';
			}
			document.getElementById("gestBoutonFonction").innerHTML = [htmlFonction];
			calculPlaceSsFct();
		}

		// Fonction ajoutée pour SCE_ZZWEB_004
		function creerNouvelleFonctionJS(libelle, nomFonction, parametres) {

			var chaineParametres = '';
			var libBulle = '';
			
			if (libelle.length > 25) {
				libBulle = libelle;
				libelle = libelle.substr(0, 22) + '...';
			}
			for(var i = 0; i < parametres.length; i++) {
				chaineParametres += '\'' + parametres[i] + '\'';
				if (i<parametres.length-1) {
					chaineParametres += ', ';
				}
			}

			var fonctionExiste = false;
			for(var i = 0; i < fonction; i++) {
				if (tabFonctions[i][0] == libelle) {
					fonctionExiste = true;
				}
			}

			if (!fonctionExiste) {
				var menu = '<A href="JavaScript:' + nomFonction + '(' + chaineParametres + ');" class="S3"';
				if (libBulle != '') {
					// SBD_TT27005 Ajout info bulle si libellé tronqué
					menu += ' title="' + libBulle + '"';
				}
				menu += '><b>&nbsp;&nbsp;'+ libelle + '</b></A><br>';
				tabFonctions[fonction] = new Array(libelle, 'VI', menu);
				fonction = fonction + 1;
			}

			_reaffichageMenu();
		}

		// Fonction ajoutée pour SCE_ZZWEB_004
		function cacherFonctionOptionnelle(nom) {
			if (nom.length > 25) {
				// SBD_TT27005 Recherche le libellé tronqué
				nom = nom.substr(0, 22) + '...';
			}
			for (var i = 0; i < fonction; i++) {
				if (tabFonctions[i][0] == nom) {
					tabFonctions[i][1] = "CA";
				}
			}
			_reaffichageMenu();
		}

		// Fonction ajoutée pour SCE_ZZWEB_004
		function montrerFonctionOptionnelle(nom) {
			if (libelle.length > 25) {
				// SBD_TT27005 Recherche le libellé tronqué
				libelle = libelle.substr(0, 22) + '...';
			}
			for (var i = 0; i < fonction; i++) {
				if (tabFonctions[i][0] == nom) {
					tabFonctions[i][1] = "VI";
				}
			}
			_reaffichageMenu();
		}
		
		/**********************************
		* Calcule le placements des boutons de navigation
		* par rapport à l'arbre et la place des fonctions
		* secondaires.
		**************************************/
		function calculPlaceBoutons()
		{
			//TT9031		
			var heightcontenuFrame = parent.heightcontenuFrame;
			if (heightcontenuFrame == 0) {
				heightcontenuFrame = parseInt(document.body.clientHeight);
				parent.heightcontenuFrame = heightcontenuFrame;
			}
			//Fin TT9031
			// on calcul la hauteur  = place + ( 30 * place par boutons)+( 15 * place par fonction)
			var height = (heightcontenuFrame - (33*boutons));
			var obj = document.getElementById('scenario');
			obj.style.height = height;
			var obj2 = document.getElementById('zonebouton');
			obj2.style.height = heightcontenuFrame - height;
			return true;
		}
		
		function calculPlaceSsFct()
		{
			var objDiv = document.getElementById('gestBoutonFonction');
			//Calcul de la place qu'il faut pour placer les sous fonctions.
			var objContainer = document.getElementById('zonebouton');
			
			objDiv.style.left = 190;
			var objDivHeight = 15*fonction;
			objDiv.style.height = objDivHeight;
			var hauteurFenetre = parseInt(document.body.clientHeight);
			var pos = 0;
			//Calcul position du calque pour que toutes les fonctions rentrent dans la fenêtre
			if (objDivHeight > objContainer.clientHeight) {
				pos = hauteurFenetre - objDivHeight;
			} else {
				pos = hauteurFenetre - objContainer.clientHeight + 20;
			}
				
			objDiv.style.top = pos;
			
			var objDesign = document.getElementById('boutGestBoutonFonction');
			objDesign.style.width = 100;
			objDesign.style.top = objContainer.clientHeight + 24;
			objDesign.style.left = 160;
			return true;
		}
		
		/***********************************************************
		* Fonction activant l'ouverture de l'aide contextuelle.
		**************************************************************/
		function openHelp()
		{
			var fonction = 'ACEK_1000';
			var scenario = 'ACCC01STD_88';
			var scenarioPere = 'ACCC01STD_88';
			var codeActe = 'ACCC';
			var codeAction = '01';
			var codeContexte = 'STD '; 
			var applicationContextRoot = "/WebAneto";
			LectureXml(codeActe,fonction,applicationContextRoot)
			//Récup du xml de correspondance code acte/nom doc (ajax).
		}
		//calculPlaceBoutons();
		
		// DEBUT AC_ZZ_STAB221_001
		// supression fonction réinitialiser dans le menu fonction
		//Affichage du bouton Reinitialiser (et donc des ss fonctions données par la jsp (appel reaffichage menu)
		//var tabReinit = new Array('LancementFonction','debuter','ACEK_1000&amp;CONTAINER_FONCTION_FORCAGE_VALIDATION=FALSE&amp;BOUTON_CONTAINER=BOUTON_INITIALISER','ACCC01STD_88');
		//creerNouvelleFonctionJS('Reinitialiser','posterFormulaire',tabReinit);
		// FIN AC_ZZ_STAB221_001
		
		
		// DEBUT STAB221_PSSP_001
		//Affiche les sous fonctions données à la JSP
		//nc 417731 by MJLI move to container.js after jqueyr.show
		//_reaffichageMenu();
		// FIN STAB221_PSSP_001
		
		//Affichage du bouton Abandonner (et donc des ss fonctions données par la jsp (appel reaffichage menu))
		
				var tabAbandon = new Array('LancementFonction','debuter','AC3U_900&amp;CONTAINER_FONCTION_FORCAGE_VALIDATION=FALSE','ACCC01STD_88');
				creerNouvelleFonctionJS('Abandonner','posterFormulaire',tabAbandon);
		

		//Check si aide présente donc bouton à afficher.
		if(!checkAide())
			document.getElementById('boutonAide').style.display = 'none';
	</SCRIPT>
</DIV></DIV>
<SCRIPT language=Javascript>
		</SCRIPT>
</DIV>
<DIV id=contenu style="HEIGHT: 800px"><!-- Cas normal de chargement d'une fonction --><LINK rel=stylesheet type=text/css href="/Commun/style/Soltim.css">
<SCRIPT language=JavaScript src="/Commun/js/calendrier.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/lov.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/cssDynamique.js"></SCRIPT>
<LINK rel=stylesheet type=text/css href="/Commun/style/cssDynamique.css">
<SCRIPT language=Javascript>
getCssValue();
</SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/lmt_navig.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/validateForm.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/editModeForm.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/MasqueSaisie.js"></SCRIPT>

<SCRIPT language=JavaScript src="/Commun/js/disabled.js"></SCRIPT>
<LINK rel=stylesheet type=text/css href="/Commun/style/disabled.css">
<SCRIPT language=JavaScript>

   // Passage du focus au prochain champ
	function nextFocus(champ, val)
	{
		lengthValue=champ.value.length;
		nextTabIndex = champ.tabIndex + 1;
		//Pas de passage de focus sur la tabulation
		if( val !=0 && lengthValue == val && event.keyCode != 9 && event.keyCode != 16 ){
			list=document.acekForm.elements;
			for(i=0;i<list.length;i++) {
				if(list[i].tabIndex==nextTabIndex) {
					//Champ non caché ou readOnly
					if(list[i].type=='hidden' || list[i].disabled==true || list[i].readOnly==true || list[i].style.visibility=='hidden' ) {
						nextTabIndex = nextTabIndex +1;
                    }
                    else {
						document.acekForm.elements(i).focus();
						break;
			        }
				}
			}
		}
		//Dernier focus actif
		lastFocus = nextTabIndex;
	}
	
	// Selection d un champ - Verifie s il peut avoir le focus 
	//Declenché sur l'evenement onfocus
	function isFocus(champ)
	{
		//Champ non caché ou readOnly
		if(champ.type=='hidden' || champ.disabled==true || champ.readOnly==true || champ.style.visibility=='hidden' ) {
			list=document.acekForm.elements;

			//Passage à l'index precedent
			if(lastFocus > champ.tabIndex) {
				nextTabIndex = champ.tabIndex -1 ;

				for(i=list.length-1;i>=0;i--) {
					if(list[i].tabIndex==nextTabIndex) {
						//Champ non caché ou readOnly
						if(list[i].type=='hidden' || list[i].disabled==true || list[i].readOnly==true || list[i].style.visibility=='hidden' ) {
							nextTabIndex = nextTabIndex -1;
	                    }
	                    else {
							document.acekForm.elements(i).focus();
							lastFocus = nextTabIndex;
							break;
				        }
					}
				}
				
			}
			//Passage à l'index suivant
			else {
				inc = 1;
				nextTabIndex = champ.tabIndex + 1;

				for(i=0;i<list.length;i++) {
					//alert("boucle n° " +i);
					if(list[i].tabIndex==nextTabIndex) {
						//Champ non caché ou readOnly
						if(list[i].type=='hidden' || list[i].disabled==true || list[i].readOnly==true || list[i].style.visibility=='hidden' ) {
							nextTabIndex = nextTabIndex + 1;
	                    }
	                    else {
							document.acekForm.elements(i).focus();
							lastFocus = nextTabIndex;
							break;
				        }
					}
				}
			}				
        }
	}
function fermerErreur()	{
	document.all['ACEKErreurs'].style.display = "none";
	document.all['ACEKNormal'].style.display = "block";
}
function initialiser()	{
	if (document.all['listeErreurs'].value != null && document.all['listeErreurs'].value != "") {
		document.all['ACEKErreurs'].style.display = "block";
		document.all['ACEKNormal'].style.display = "none";
	}
}
</SCRIPT>

<META name=GENERATOR content="IBM WebSphere Studio"><INPUT type=hidden name=listeErreurs>
<SCRIPT language=javascript>
function invalidateZZToken(form) {
if(form!= null && form._zzToken_ != null){
form._zzToken_.value = false;
}
zzDisableHref('true');
}
function isZZTokenValid(form) {
if(form!= null && form._zzToken_ != null){
var tokenValue = form._zzToken_.value;
if (tokenValue == 'true') {
return true;
}
}
else return true;
return false;
}
function zzSubmitForm(form) {
if(isZZTokenValid(form)){
if(!pageIsReloaded){
invalidateZZToken(form);
}else{
pageIsReloaded = false;
}
form.submit();
}
}
function zzValidateFormWithTokenActivateacekForm(form){
if(isZZTokenValid(form) && zzPersonnalOnsubmitacekForm() ){
invalidateZZToken(form);
return true;
}
return false;
}
function zzPersonnalOnsubmitacekForm(form) {

 return true;
}
</SCRIPT>
 
<FORM onsubmit="return zzValidateFormWithTokenActivateacekForm(this);" method=post name=acekForm action=#><INPUT id=_zzToken_ type=hidden value=true name=_zzToken_> 
<DIV id=ACEKNormal style="DISPLAY: block">
<SCRIPT language=Javascript>		
	var parametreRequete='&CONTAINER_NOM_SCENARIO_ENREGISTREMENT=ACCC01STD_88&CONTAINER_NOM_FONCTION=ACEK_1000&AFFICHAGE_CONTAINER=';
	// Gestion de la touche Entrée
	if (navigator.appName.indexOf("Explorer") == -1) {
	       	document.captureEvents(Event.KEYPRESS);
        	document.onkeypress = voir;
        } else {
	       	document.onkeypress = clavier;
	}
		
     
    function voir (e){
	    KeyPressed(e.which);
    }
    function clavier()  {
        //IE
		KeyPressed(window.event.keyCode);
    }
    function KeyPressed(key) {
        if (key == 13) {
        	// Touche entrée
		    goSubmit('ACEK','doRechercherAssures');
	    }
	    if (key == 27) {
			// Touche échappement
		    AnnuleModifs();
	    }
	}	


	<!-- Submit du formulaire -->
	function goSubmit(nomFonction,nomMethode) 
	{
	    var nomFormulaire = "acekForm";
	    var nomDomaine = "contrat";
		var requete = '/WebAneto' + '/' +  nomDomaine + '/' 
		+ nomFonction + '.do?method=' + nomMethode;
		document.forms[nomFormulaire].action= requete + parametreRequete;
		document.forms[nomFormulaire].submit();		
	}
	
	function setEtatCkecksBox(typesel)	{
		//alert(typesel)		
		if (typesel == "tous"){
			// Pour tous les assurés : Cocher toutes les checkbox et les désactiver
			for (i=0; i < document.all('nombreAssures').value; i++) {
				document.all('selectionAssure['+i+']').checked=true;				
				document.all('selectionAssure['+i+']').disabled=true;
			}
		}else{
			// Pour les assurés sélectionnés :  Activer toutes les checkbox
			for (i=0; i < document.all('nombreAssures').value; i++) {
				if (document.all('selectionAssure['+i+']').id=='true')
					document.all('selectionAssure['+i+']').checked=true;
				else
					document.all('selectionAssure['+i+']').checked=false;
				document.all('selectionAssure['+i+']').disabled=false;				
			}			
		}
	}
	
	function lockChamps(typeEdition, mode, indUtilisationFonction)	{
		activerValidationFonction();
		
		if (mode=="01" && indUtilisationFonction =="1" && document.all('numeroContratIndividuel').value != "") {

			// PHDE le 21/02/2007 (anomalie RE-V2.1.4-ACSO-006) : 
			// Le bouton "Rechercher" est grisé une fois les informations du contrat affichées
			document.all('btRechercheAssures').disabled=true;

			// Mode création et fonction autorisée
			// Etat bouton type d'édition immédiate			
			if (document.all('indTypeEditCarteImmediateAutorise').value == "1"){
				// Edition immédiate autorisée
				<!-- BPN_RE-V2.1.4-ACCU-001 -->
				document.all('typeEdition1').disabled=false;	
			}else{
				// Edition immédiate non autorisée			
				<!-- BPN_RE-V2.1.4-ACCU-001 -->
				document.all('typeEdition1').disabled=true;
			}

			// Etat bouton édition carte pour les assurés sélectionnés
			if (document.all('indEditCarteAssuresSelAutorisee').value == "1"){
				// Edition cartes pour assurés sélectionnés autorisée
				document.all('destinationEditionSel').disabled=false;	
			}else{
				// Edition cartes pour assurés sélectionnés non autorisée
				document.all('destinationEditionSel').disabled=true;
			}
			
			// Etat liste des types de cartes TP
			if (document.all('indAutorisModifListeTypeEditionCarte').value == "1"){
				// Modification liste type de carte TP autorisée
				document.all('codeTypeEditionCarteTP').disabled=false;
				document.all('destEditionTous').disabled=false;
				document.all('destEditionSel').disabled=false;			
			}else{
				// Modification liste type de carte TP non autorisée
				document.all('codeTypeEditionCarteTP').disabled=true;
				document.all('destEditionTous').disabled=true;
				document.all('destEditionSel').disabled=true;	
			}			

			if (document.acekForm.typeEdition[2].checked == true){
				// Type édition = "sans" : Décocher toutes les checkbox et les désactiver
				for (i=0; i < document.all('nombreAssures').value; i++) {
					document.all('selectionAssure['+i+']').checked=false;
					document.all('selectionAssure['+i+']').disabled=true;
				}
				document.all('dateDebutValidite').readOnly=true;			
				document.all('dateFinValidite').readOnly=true;			
				document.all('dateEdition').readOnly=true;			
				document.acekForm.destinationEdition[0].disabled=true;			
				document.acekForm.destinationEdition[1].disabled=true;
				
				
				// Masquage des calendriers
				for(i=0;i!=document.images.length;i++)
	        	   if(document.images[i].alt=='Calendrier')
		        		document.images[i].style.visibility='hidden';
				
			}else{
				// Type édition = "Immédiate" ou "Différée"
	
				document.all('dateDebutValidite').readOnly=false;			
				document.all('dateFinValidite').readOnly=false;			
				document.all('dateEdition').readOnly=false;			
				document.acekForm.destinationEdition[0].disabled=false;			

				if (document.all('indEditCarteAssuresSelAutorisee').value == "1")
					document.acekForm.destinationEdition[1].disabled=false;				
					
				// Démasquage des calendriers
				for(i=0;i!=document.images.length;i++)
	        	   if(document.images[i].alt=='Calendrier')
		        		document.images[i].style.visibility='visible';
						
				var typesel = "";
				elementsForm=document.forms['acekForm'].elements;
				for(i=0;i!=elementsForm.length;i++){
					if (elementsForm[i].name=='destinationEdition'){
					  if (elementsForm[i].id=='destinationEditionTous') {
					  	if (elementsForm[i].checked == true)
					  		typesel="tous";
					  	else
						  	typesel="sel";
					  }
					}	
				}
				setEtatCkecksBox(typesel);
			}		
		}else{

			//On ne passe pas par la validation
//			if (mode!="01" || indUtilisationFonction !="1" ) {
			if (mode!="01") {
				desactiverValidationFonction();
			}

			// Mode consultation ou fonction non autorisée
			for (i=0; i < document.all('nombreAssures').value; i++) {
				document.all('selectionAssure['+i+']').checked=false;
				document.all('selectionAssure['+i+']').disabled=true;
			}
			document.all('dateDebutValidite').readOnly=true;			
			document.all('dateFinValidite').readOnly=true;			
			document.all('dateEdition').readOnly=true;			
			document.acekForm.destinationEdition[0].disabled=true;							
			document.acekForm.destinationEdition[1].disabled=true;							
			document.all('typeEdition1').disabled=true;
			document.all('typeEdition2').disabled=true;					
			document.all('typeEdition3').disabled=true;					
			
			// Masquage des calendriers
			for(i=0;i!=document.images.length;i++)
	        	if(document.images[i].alt=='Calendrier')
		        	document.images[i].style.visibility='hidden';

			document.all('codeTypeEditionCarteTP').disabled=true;
			
			//--ED-V2.1.2-ACCC-002[BBO]15/10/2007
			if(document.all('numeroContratIndividuel').value != ""){
				document.getElementById("btRechercheAssures").style.visibility = "hidden";	
			}
			//--FIN ED-V2.1.2-ACCC-002	
		}

	}


</SCRIPT>
<INPUT type=hidden value=1 name=nombreAssures> <INPUT type=hidden name=oldTypeEdition> <INPUT type=hidden value=1 name=indTypeEditCarteImmediateAutorise> <INPUT type=hidden value=1 name=indEditCarteAssuresSelAutorisee> <INPUT type=hidden value=0 name=indAutorisModifListeTypeEditionCarte> <INPUT id=numeroContratIndividuel type=hidden value=21452751 name=numeroContratIndividuel> 
<TABLE width="100%" border=0>
<TBODY>
<TR>
<TD class=TitreGroupeB colSpan=3>Identification Adhésion</TD></TR>
<TR class=LibelleB2>
<TD class=LibelleB2 width="20%">N° contrat individuel : </TD>
<TD class=DonneeB2 colSpan=2>21452751 </TD></TR></TBODY></TABLE>
<TABLE width="100%" border=0>
<TBODY>
<TR>
<TD align=center><A tabIndex=2 disabled id=btRechercheAssures title="Rechercher assurés" class=AdminBT_B href="Javascript:goSubmit('ACEK','doRechercherAssures');">Rechercher</A></TD></TR></TBODY></TABLE>
<TABLE width="100%" border=0>
<TBODY>
<TR>
<TD class=TitreGroupeB colSpan=5>Génération de l'édition</TD></TR>
<TR class=LibelleB1>
<TD>
<TABLE width="100%" border=0>
<TBODY>
<TR class=LibelleB2>
<TD>Date de début de validité : </TD>
<TD><INPUT tabIndex=3 onkeypress=Javascript:masqueSaisieDateFormate(this) onkeyup=Javascript:nextFocus(this,10) onblur=controleFormatDate(this); maxLength=10 size=15 value=01/05/2017 name=dateDebutValidite>&nbsp;<A tabIndex=3 id=cache href="JavaScript:show_calendar('','acekForm.dateDebutValidite')" name=dateDebutValidite_IMG><IMG id=cache style="VISIBILITY: visible" border=0 alt=Calendrier src="/Commun/multimedia/images/calendar.gif"></A> </TD></TR>
<TR class=LibelleB2>
<TD>Date de fin de validité : </TD>
<TD><INPUT tabIndex=4 onkeypress=Javascript:masqueSaisieDateFormate(this) onkeyup=Javascript:nextFocus(this,10) onblur=controleFormatDate(this); maxLength=10 size=15 value=31/12/2017 name=dateFinValidite>&nbsp;<A tabIndex=4 id=cache href="JavaScript:show_calendar('','acekForm.dateFinValidite')" name=dateFinValidite_IMG><IMG id=cache style="VISIBILITY: visible" border=0 alt=Calendrier src="/Commun/multimedia/images/calendar.gif"></A> </TD></TR>
<TR class=LibelleB2>
<TD>Date d'édition : </TD>
<TD><INPUT tabIndex=5 onkeypress=Javascript:masqueSaisieDateFormate(this) onkeyup=Javascript:nextFocus(this,10) onblur=controleFormatDate(this); maxLength=10 size=15 value=17/05/2017 name=dateEdition>&nbsp;<A tabIndex=5 id=cache href="JavaScript:show_calendar('','acekForm.dateEdition')" name=dateEdition_IMG><IMG id=cache style="VISIBILITY: visible" border=0 alt=Calendrier src="/Commun/multimedia/images/calendar.gif"></A> </TD></TR></TBODY></TABLE></TD>
<TD vAlign=top>
<TABLE width="100%" border=0>
<TBODY>
<TR>
<TD class=TitreGroupeB colSpan=2>Type d'édition</TD></TR>
<TR class=LibelleB2>
<TD><INPUT onclick="Javascript:lockChamps('1','01','1')" tabIndex=6 id=typeEdition1 type=radio value=1 name=typeEdition>Immediate</TD></TR>
<TR class=LibelleB2>
<TD><INPUT onclick="Javascript:lockChamps('2','01','1')" tabIndex=7 id=typeEdition2 CHECKED type=radio value=2 name=typeEdition>Différée</TD></TR>
<TR class=LibelleB2>
<TD><INPUT onclick="Javascript:lockChamps('3','01','1')" tabIndex=8 id=typeEdition3 type=radio value=3 name=typeEdition>Sans</TD></TR></TBODY></TABLE></TD>
<TD width="2%">&nbsp;</TD>
<TD vAlign=top>
<TABLE width="100%" border=0>
<TBODY>
<TR>
<TD width="100%">
<TABLE width="100%" border=0>
<TBODY>
<TR>
<TD class=TitreGroupeB colSpan=2>Edition carte</TD></TR>
<TR class=LibelleB2>
<TD disabled id=destEditionTous><INPUT onclick="Javascript:setEtatCkecksBox('tous')" tabIndex=9 id=destinationEditionTous CHECKED type=radio value=1 name=destinationEdition>Pour tous les Adhérents</TD></TR>
<TR class=LibelleB2>
<TD disabled id=destEditionSel><INPUT onclick="Javascript:setEtatCkecksBox('sel')" tabIndex=10 id=destinationEditionSel type=radio value=2 name=destinationEdition>Pour les Adhérents sélectionnés</TD></TR></TBODY></TABLE></TD></TR><!-- FDU - STAB221_SPH1196_01 - 17/12/07 --><INPUT type=hidden value=1 name=destinationEdition> 
<TR class=LibelleB2>
<TD noWrap>Type de carte TP :&nbsp; <SELECT onchange="" tabIndex=11 disabled id=nonbloque name=codeTypeEditionCarteTP> <OPTION value=""></OPTION> <OPTION selected value=5>Par contrat</OPTION> <OPTION value=6>Par assuré soc</OPTION> <OPTION value=7>Par assuré</OPTION></SELECT> </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><INPUT type=hidden name=actionvalue> 
<TABLE width="100%" border=0>
<TBODY>
<TR align=left vAlign=bottom>
<TD noWrap>
<DIV class=TitreGroupeB>Adhérents</DIV></TD></TR></TBODY></TABLE>
<DIV class=Liste_B style="HEIGHT: 260px; WIDTH: 845px">
<TABLE id=TableAssures width="100%" border=0>
<TBODY>
<TR class=LILibelleB1 align=center>
<TD noWrap>&nbsp;</TD>
<TD noWrap>E </TD>
<TD noWrap>Rang </TD>
<TD noWrap>Nom et prénom de l'Assuré </TD>
<TD noWrap>Date de naissance </TD>
<TD noWrap>Type d'Assuré </TD>
<TD noWrap>Début d'effet </TD>
<TD noWrap>Fin d'effet </TD></TR><!-- Boucle sur la liste des assurés -->
<TBODY id=_pageAssure_1_ style="DISPLAY: block">
<TR onmouseover="JavaScript:MouseOver('0','TableAssures','B');" onmouseout="JavaScript:MouseOut('0','TableAssures','B',numeroLigneActive);" id=0 class=LIDonneeB1 style="BACKGROUND-COLOR: #e1f1ff">
<TD><INPUT disabled CHECKED type=checkbox value=0 name=selectionAssure[0]></TD>
<TD noWrap align=center>VA</TD>
<TD noWrap>1</TD>
<TD noWrap>CHARLOT GUY</TD>
<TD noWrap align=center>19/09/1949</TD>
<TD noWrap>Ass principal</TD>
<TD noWrap align=center>01/01/2016</TD>
<TD noWrap align=center></TD></TR></TBODY></TABLE></DIV></DIV>
<DIV id=ACEKErreurs style="DISPLAY: none">
<TABLE width="100%" border=0>
<TBODY>
<TR class=TitreGroupeB>
<TD>
<TABLE width="100%" border=0>
<TBODY>
<TR class=TitreGroupeB>
<TD class=TitreGroupeB>Liste des anomalies</TD></TR></TBODY></TABLE></TD></TR>
<TR>
<TD align=center><A class=AdminBT_B href="javascript:fermerErreur();">Fermer</A> </TD></TR></TBODY></TABLE></DIV></FORM>
<SCRIPT type=text/javascript>var pageIsReloaded = true;</SCRIPT>
</DIV>
<SCRIPT>
//TT9031
//		heightcontenuFrame = (document.body.clientHeight);
//		var heightcontenuFrame = (document.body.clientHeight);
//		var obj = document.getElementById('contenu');
//		obj.style.height = heightcontenuFrame;
		//calculPlaceBoutons();
	</SCRIPT>
</DIV>
<SCRIPT language=JavaScript>
	
</SCRIPT>
<!-- Partie permettant la persistance du bandeau en cas d'erreur s'il existe -->
<SCRIPT language=JavaScript>
zzBlocageArbreAction();
function gestionRetourErreurBandeau()
{
	if(presenceBandeau=='true')
		gestionRetourPageErreur();
	var liste= document.forms;
	if(liste!=null)
	for(i=0;i<liste.length;i++)
		if(liste[i]!=null && liste[i]._zzToken_!=null)
			liste[i]._zzToken_.value='true';
}
</SCRIPT>
<IFRAME onload=JavaScript:gestionRetourErreurBandeau();appelUrl();appelUrlCalligo(); height=0 src="#" frameBorder=0 width=0 ?>
</IFRAME>
<META content=no-cache http-equiv=Pragma>
<META content=-1 http-equiv=Expires><INPUT id=notificationPluginShowError style="CURSOR: hand; HEIGHT: 23px; WIDTH: 23px; RIGHT: 2px; POSITION: absolute; DISPLAY: none; TOP: 2px; index: 9998" src="/Commun/multimedia/images/notification/error.png" type=image jQuery17105285885181812099="2"></INPUT></BODY></HTML>